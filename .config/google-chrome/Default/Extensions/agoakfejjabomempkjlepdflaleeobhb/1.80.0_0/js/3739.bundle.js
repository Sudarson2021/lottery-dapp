"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="81290897-da49-54dd-9269-d8cba783a27f")}catch(e){}}();
(self.webpackChunkavalanche_extension=self.webpackChunkavalanche_extension||[]).push([[3739],{19108:(e,t,n)=>{function a(e){return Boolean(e?.addressBTC)}n.d(t,{Z:()=>a})},80677:(e,t,n)=>{n.d(t,{X:()=>i});var a=n(67294),r=n(94975),o=n(69518),s=n(27624),c=n(46935);const i=()=>{const{tabId:e,events:t,request:n}=(0,o.K)(),[i,l]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[d,E]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1);return{isLoading:u,isValidSession:i,isNewConnectionRequired:p,establishRequiredSession:(0,a.useCallback)((async(a,o)=>{g(!1),m(!0);const i=t().pipe((0,r.h)(s.ts)).subscribe((async t=>{t.value.tabId===e&&(m(!1),(0,s.WR)(t)&&g(!0),(0,s.h8)(t)&&(E(t.value.activeSession),l(!1)))}));n({method:c.a.WALLET_CONNECT_ESTABLISH_REQUIRED_SESSION,params:[a,o]}).then((e=>{E(e),l(!0)})).catch((()=>{E(null),l(!1),g(!0)})).finally((()=>{i.unsubscribe()}))}),[t,e,n]),activeSession:d}}},85466:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(93e3),r=n(9830);const o=()=>{const{accounts:{active:e}}=(0,r.a)();return e?.type===a.Qm.FIREBLOCKS}},92094:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(93e3),r=n(36553),o=n(9830),s=n(64631);const c=()=>{const{walletDetails:e}=(0,s.t)(),{accounts:{active:t}}=(0,o.a)();return e?.type===r.Y.Keystone&&t?.type===a.Qm.PRIMARY}},60917:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(93e3),r=n(9830);const o=()=>{const{accounts:{active:e}}=(0,r.a)();return e?.type===a.Qm.WALLET_CONNECT}},63284:(e,t,n)=>{n.d(t,{y:()=>o});var a=n(68483),r=n(67294);const o=({badgeIcon:e="walletConnect"})=>r.createElement(a.Cts,{overlap:"circular",badgeContent:r.createElement(a.qEK,{sx:{width:"24px",height:"24px",backgroundColor:"walletConnect"===e?"info.dark":"transparent",border:"1px solid",borderColor:"background.paper"}},"walletConnect"===e&&r.createElement(a.JwX,{size:16}),"bitcoin"===e&&r.createElement(a.xFY,{size:24})),anchorOrigin:{vertical:"bottom",horizontal:"right"}},r.createElement(a.qEK,{sx:{width:"64px",height:"64px",background:"transparent",border:"1px solid",borderColor:"primary.main"}},r.createElement(a.O$2,{size:32})))},35291:(e,t,n)=>{n.d(t,{A:()=>N});var a=n(43023),r=n(67294),o=n(80677),s=n(9830),c=n(68483),i=n(26793),l=n(31006),u=n(49530),m=n(93e3);const d=function(e,t){return e.vmName!==u.mK.CoreEth&&(t.type===m.Qm.FIREBLOCKS||t.type===m.Qm.WALLET_CONNECT)&&e.vmName!==u.mK.BITCOIN};var E=n(26396),p=n(790),g=n(62440),C=n(45938),y=n(63284),x=n(95280),v=n(19108),S=n(32738),R=n(67294);function h({account:e,activeStep:t,useWalletConnectApproval:n,onReject:o,onSign:s,session:i,isValidSession:l}){const{network:u}=(0,a.g)(),m=(0,r.useMemo)((()=>t===E.R.SENT?R.createElement(b,null):n?l?R.createElement(w,null):R.createElement(T,null):R.createElement(w,null)),[t,l,n]),d=(0,r.useMemo)((()=>n?l:(0,S.Uc)(e)&&(0,v.Z)(e)),[e,l,n]),p=(0,r.useMemo)((()=>!!u&&(0,x.N)(u)),[u]);return R.createElement(C.s,{logo:R.createElement(y.y,{badgeIcon:p?"bitcoin":"walletConnect"}),status:m,isValidSession:d,connectingToIcon:R.createElement(c.O$2,null),useRetryButton:!0,useWalletConnectApproval:n,account:e,session:i,onReject:o,onSign:s})}const b=()=>R.createElement(c.Kqy,{sx:{columnGap:1,flexDirection:"row",alignItems:"center"}},R.createElement(c.D8x,{size:16}),R.createElement(c.ZT$,{variant:"body1"},R.createElement(g.c,{i18nKey:"Signing request sent"}))),w=()=>R.createElement(c.Kqy,{sx:{columnGap:1,flexDirection:"row",alignItems:"center"}},R.createElement(c.rE2,{sx:{color:"success.main"}}),R.createElement(c.ZT$,{variant:"body1"},R.createElement(g.c,{i18nKey:"Connected and ready to sign"}))),T=()=>R.createElement(c.Kqy,{sx:{columnGap:1,flexDirection:"row",alignItems:"start"}},R.createElement(c.lMq,{sx:{color:"warning.main",pt:.5}}),R.createElement(c.ZT$,{variant:"body1"},R.createElement(g.c,{i18nKey:"Wrong network. Please switch networks on your mobile device."})));var f=n(67294);function N({onReject:e,onSubmit:t}){const{t:n}=(0,i.$)(),{network:u}=(0,a.g)(),{accounts:{active:m}}=(0,s.a)(),[g,C]=(0,r.useState)(!1),{activeSession:x,isValidSession:v,isNewConnectionRequired:S,establishRequiredSession:R}=(0,o.X)(),b=(0,r.useMemo)((()=>{if(u&&m)return d(u,m)}),[m,u]),w=(0,r.useMemo)((()=>void 0===b?E.R.LOADING:b?(0,E.$)(g,x,S):g?E.R.SENT:E.R.APPROVAL),[g,S,x,b]),T=(0,r.useMemo)((()=>{switch(w){case E.R.APPROVAL:return n("Fireblocks Approval");case E.R.CONNECT:return n("Scan QR Code to Connect");default:return""}}),[w,n]);return(0,r.useEffect)((()=>{m&&u&&R(m.addressC,u.chainId)}),[m,u,R]),f.createElement(p.F,{onReject:e,pageTitle:T},w===E.R.LOADING&&f.createElement(c.Kqy,{sx:{alignItems:"center",justifyContent:"center",mt:20}},f.createElement(c.D8x,{size:80})),(w===E.R.APPROVAL||w===E.R.SENT)&&f.createElement(h,{account:m,useWalletConnectApproval:void 0!==b&&b,activeStep:w,session:x,isValidSession:v,onReject:e,onSign:()=>{C(!0),t()}}),w===E.R.CONNECT&&f.createElement(l.N,{appIcon:f.createElement(y.y,null),reconnectionAddress:m?.addressC,customMessage:n("Please reconnect using Wallet Connect to add this network to authorized networks."),onConnect:()=>{R(m?.addressC,u?.chainId)}}))}},45938:(e,t,n)=>{n.d(t,{s:()=>i});var a=n(68483),r=n(45246),o=n(36609),s=n(67294),c=n(67294);function i({logo:e,status:t,isValidSession:n,connectingToIcon:i,useRetryButton:l,useWalletConnectApproval:u,onReject:m,onSign:d,account:E,session:p}){const[g,C]=(0,s.useState)(!1),[y,x]=(0,s.useState)(!0),v=(0,s.useMemo)((()=>!!l&&!!g),[g,l]);return c.createElement(a.Kqy,{sx:{alignItems:"center"}},e,c.createElement(a.Kqy,{divider:c.createElement(a.izJ,null),sx:{rowGap:2,width:"100%",px:3}},E&&c.createElement(a.Kqy,{sx:{rowGap:.5}},c.createElement(a.ZT$,{variant:"body2",sx:{color:"text.secondary"}},(0,o.t)("Wallet")),c.createElement(a.ZT$,{variant:"body1"},E.name),c.createElement(a.ZT$,{variant:"body2",sx:{color:"text.secondary"}},(0,r.F)(E.addressC))),p&&c.createElement(a.Kqy,{sx:{rowGap:.5}},c.createElement(a.ZT$,{variant:"body2",sx:{color:"text.secondary"}},(0,o.t)("Connecting to")),c.createElement(a.Kqy,{sx:{flexDirection:"row",columnGap:1,alignItems:"center"}},i,c.createElement(a.ZT$,{variant:"body1"},p?.walletApp?.name))),c.createElement(a.Kqy,{sx:{rowGap:.5}},c.createElement(a.ZT$,{variant:"body2",sx:{color:"text.secondary"}},(0,o.t)("Status")),t)),c.createElement(a.Kqy,{sx:{alignItems:"flex-end",justifyContent:"center",flexDirection:"row",width:"100%",columnGap:1,mt:10,pb:3,px:3}},c.createElement(a.zxk,{size:"large",color:"secondary",fullWidth:!0,onClick:()=>{C(!1),m()},disabled:g},(0,o.t)("Reject")),c.createElement(a.zxk,{size:"large",fullWidth:!0,onClick:()=>{C(!0),x(!1),u&&setTimeout((()=>x(!0)),5e3),d()},disabled:!n||!y},v&&g?(0,o.t)("Retry"):(0,o.t)("Sign"))))}},790:(e,t,n)=>{n.d(t,{F:()=>o});var a=n(68483),r=n(67294);function o({onReject:e,pageTitle:t,children:n}){return r.createElement(a.VqE,{open:!0,showCloseIcon:!1,PaperProps:{sx:{m:2,width:1,height:1,maxWidth:"none",position:"relative"}}},r.createElement(a.hU,{onClick:e,sx:{position:"absolute",top:8,right:8,p:1},disableRipple:!0},r.createElement(a.b0D,{size:24})),r.createElement(a.ZT$,{variant:"h4",sx:{py:3,pl:3,pr:6}},t),n)}},31006:(e,t,n)=>{n.d(t,{N:()=>c});var a=n(68483),r=n(85416),o=n(74510),s=n(67294);function c({reconnectionAddress:e,customMessage:t,onConnect:n,appIcon:c}){return s.createElement(a.Kqy,{sx:{alignItems:"center",height:"100%",gap:2}},c??s.createElement(r.D,null),s.createElement(o.Z,{reconnectionAddress:e,customMessage:t,onConnect:n}))}},65124:(e,t,n)=>{n.d(t,{m:()=>T});var a=n(68483),r=n(67294),o=n(26793),s=n(9830),c=n(43023),i=n(80677),l=n(90948),u=n(62440),m=n(85416),d=n(68792),E=n(45938),p=n(67294);const g=(0,l.ZP)(d.J)`
  width: 24px;
  height: 24px;
  border-radius: 12px;
`;function C({account:e,session:t,onReject:n,onSign:a,isValidSession:r}){return p.createElement(E.s,{logo:p.createElement(m.D,null),status:r?p.createElement(y,null):p.createElement(x,null),isValidSession:r,connectingToIcon:p.createElement(g,{src:t?.walletApp?.icons[0]}),useRetryButton:!1,useWalletConnectApproval:!0,account:e,session:t,onReject:n,onSign:a})}const y=()=>p.createElement(a.Kqy,{sx:{columnGap:1,flexDirection:"row",alignItems:"center"}},p.createElement(a.rE2,{sx:{color:"success.main"}}),p.createElement(a.ZT$,{variant:"body1"},p.createElement(u.c,{i18nKey:"Connected and ready to sign"}))),x=()=>p.createElement(a.Kqy,{sx:{columnGap:1,flexDirection:"row",alignItems:"start"}},p.createElement(a.lMq,{sx:{color:"warning.main",pt:.5}}),p.createElement(a.ZT$,{variant:"body1"},p.createElement(u.c,{i18nKey:"Wrong network. Please switch networks on your mobile device."})));var v=n(31006),S=n(67294);function R({onResend:e,currentSignature:t,requiredSignatures:n}){const{t:s}=(0,o.$)(),[c,i]=(0,r.useState)(!0),l=(0,r.useRef)(),u=n>1,m=(0,r.useCallback)((()=>{void 0!==l.current&&clearTimeout(l.current),l.current=setTimeout((()=>{i(!1),l.current=void 0}),7500)}),[]);return(0,r.useEffect)((()=>(m(),()=>{void 0!==l.current&&clearTimeout(l.current)}))),S.createElement(a.Kqy,{sx:{justifyContent:"start",width:"100%",height:"100%",px:3}},u&&S.createElement(a.bZj,{severity:"info"},S.createElement(a.CdC,null,s("This transaction requires two approvals")),s("Please pay attention to your mobile device")),S.createElement(a.Kqy,{sx:{gap:1,alignItems:"center",mt:u?5:10,textAlign:"center"}},S.createElement(a.rE2,{size:72,sx:{color:"success.main"}}),!u&&S.createElement(S.Fragment,null,S.createElement(a.ZT$,{variant:"h5"},s("Request Successfully Sent!")),S.createElement(a.ZT$,{variant:"body2",sx:{color:"text.secondary"}},s("Please sign on your mobile wallet."))),u&&S.createElement(S.Fragment,null,S.createElement(a.ZT$,{variant:"h5"},s(1===t?"First Request Sent!":"Almost done!")),S.createElement(a.ZT$,{variant:"body2",sx:{color:"text.secondary"}},s(1===t?"Please approve it on your mobile wallet.":"Please approve the second request, too."))),1===t&&S.createElement(a.Kqy,{sx:{px:3,mt:1,width:"100%"}},S.createElement(a.zxk,{fullWidth:!0,onClick:function(){i(!0),e(),m()},size:"xlarge",disabled:c,isLoading:c},s("Resend")))))}var h=n(790),b=n(26396),w=n(67294);function T({onReject:e,onSubmit:t,requiredSignatures:n=1,currentSignature:l=1}){const{t:u}=(0,o.$)(),{network:m}=(0,c.g)(),{accounts:{active:d}}=(0,s.a)(),{activeSession:E,isValidSession:p,isNewConnectionRequired:g,establishRequiredSession:y}=(0,i.X)(),[x,S]=(0,r.useState)(!1),T=(0,r.useMemo)((()=>(0,b.$)(x,E,g)),[x,g,E]),f=(0,r.useMemo)((()=>{switch(T){case b.R.APPROVAL:return u("Wallet Connect Approval");case b.R.CONNECT:return u("Scan QR Code to Connect");default:return""}}),[T,u]);function N(){S(!0),t()}return(0,r.useEffect)((()=>{d&&m&&y(d.addressC,m.chainId)}),[d,m,y]),w.createElement(h.F,{onReject:e,pageTitle:f},{[b.R.LOADING]:w.createElement(a.Kqy,{sx:{alignItems:"center",justifyContent:"center",mt:20}},w.createElement(a.D8x,{size:80})),[b.R.APPROVAL]:w.createElement(C,{account:d,session:E,isValidSession:p,onReject:e,onSign:N}),[b.R.CONNECT]:w.createElement(v.N,{reconnectionAddress:d?.addressC,customMessage:u("Please reconnect using Wallet Connect to add this network to authorized networks."),onConnect:()=>{y(d?.addressC,m?.chainId)}}),[b.R.SENT]:w.createElement(R,{onResend:N,requiredSignatures:n,currentSignature:l})}[T])}},26396:(e,t,n)=>{n.d(t,{$:()=>r,R:()=>a});let a=function(e){return e[e.APPROVAL=0]="APPROVAL",e[e.CONNECT=1]="CONNECT",e[e.SENT=2]="SENT",e[e.LOADING=3]="LOADING",e}({});const r=(e,t,n)=>e?a.SENT:t&&!n?a.APPROVAL:n?a.CONNECT:a.LOADING}}]);
//# debugId=81290897-da49-54dd-9269-d8cba783a27f
