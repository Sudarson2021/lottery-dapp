
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ecfcfd2e-047d-5c90-9d7b-c217f350b365")}catch(e){}}();
(self.webpackChunkavalanche_extension=self.webpackChunkavalanche_extension||[]).push([[9792],{87796:(e,t,n)=>{"use strict";function r(e,t=2){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:t}).format(e.toNumber())}n.d(t,{L:()=>r})},81637:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var r=n(93302),s=n.n(r);function a(e,t){const n=Math.floor(t);if(n<0)throw new Error("Denomination can not be less that 0.");const r=e.mul(s()(10).pow(n)).toFixed(0,0);return BigInt(r)}},7248:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var r=n(27822),s=n(739);function a(e,t=9){const n=(0,s.N)(e,t);return(0,r.v)(n,t)}},5099:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(93302),s=n.n(r),a=n(13550),o=n.n(a);function i(e,t){const n="string"==typeof e?s()(e.replace(/,/gi,"")):s()(e),r=s()(10).pow(t);return new(o())(n.times(r).toFixed(0))}},45524:(e,t,n)=>{"use strict";async function r(e){try{return[await e,null]}catch(e){return[null,e]}}n.d(t,{D:()=>r})},54876:(e,t,n)=>{"use strict";function r(){return BigInt(Math.floor(Date.now()/1e3))}n.d(t,{P:()=>r})},18541:(e,t,n)=>{"use strict";n.d(t,{i:()=>a});var r=n(17656),s=n(23085).lW;function a(e,t,n){const a=new r._B({network:n});return e.forEach((e=>{a.addInput({hash:e.txHash,index:e.index,witnessUtxo:{script:s.from(e.script,"hex"),value:e.value}})})),t.forEach((e=>{a.addOutput({value:e.value,address:e.address})})),a}},38490:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});var r=n(18541),s=n(10069),a=n(7482),o=n(25108);function i(e,t,n,i,d,u){const c=(0,a.v)(d),l=(0,s.e)(e,t,n,i,c);return l.inputs?{...l,psbt:(0,r.i)(l.inputs,l.outputs,u)}:(o.log("Unable to construct transaction, fee needed: ",l.fee),l)}},7482:(e,t,n)=>{"use strict";function r(e){const t=[];return e.filter((e=>{const n=e.txHash+e.index.toString();return!t.includes(n)&&(t.push(n),!0)}))}n.d(t,{v:()=>r})},96663:(e,t,n)=>{"use strict";n.d(t,{L:()=>a});var r=n(10069),s=n(96885);function a(e,t,n,a){const o=(0,s.s)(e);if(!o)return 0;const{fee:i}=(0,r.e)(t,n,o,a,e);return o-i}},10069:(e,t,n)=>{"use strict";n.d(t,{e:()=>a});var r=n(92213),s=n.n(r);function a(e,t,n,r,a){const o=[{address:e,value:n}],{inputs:i,outputs:d,fee:u}=s()(a,o,r);if(!i||!d)return{fee:u};const c=[d[0]],l=d[1];return l&&c.push({address:t,value:l.value}),{inputs:i,outputs:c,fee:u}}},14479:(e,t,n)=>{"use strict";n.d(t,{Y:()=>u});var r=n(1336),s=n(26793),a=n(62440),o=n(2409),i=n(68483),d=n(67294);function u({functionName:e,network:t,children:n}){const{t:u}=(0,s.$)(),c=(0,o.e)(e)??u("This Feature");return d.createElement(i.Kqy,{sx:{width:"100%",height:"100%"}},d.createElement(r.V,{variant:r.D.PRIMARY},c),d.createElement(i.Kqy,{sx:{flexGrow:1,px:4,alignContent:"center",justifyContent:"center"}},d.createElement(i.ZT$,{variant:"body1",minHeight:24,align:"center"},d.createElement(a.c,{i18nKey:"Sorry, {{functionName}} on<br/>{{network}} network<br/>is not supported by this account.",values:{functionName:c,network:t}})),n))}},32672:(e,t,n)=>{"use strict";n.d(t,{T:()=>l});var r=n(87462),s=n(68483),a=n(57832),o=n(67294),i=n(67294);const d="50%",u="32px",c=e=>{const t=(e||"").split(" "),n=t[0],r=t[t.length-1];return n&&r?n.substring(0,1)+r.substring(0,1):n?n.substring(0,1):""};function l({src:e,children:t,width:n,height:l,name:m,...f}){const[g,h]=(0,o.useState)();if((0,o.useEffect)((()=>{let t=!1;return new Promise(((t,n)=>{if(!e)return void n("no source value");const r=document.createElement("img");r.onerror=e=>{n(e)},r.onload=()=>{t(r)},r.src=(0,a.w)(e)})).then((()=>{!t&&h({success:!0})})).catch((()=>{!t&&h({error:!0})})),()=>{t=!0}}),[m,e]),!g)return i.createElement(s.Kqy,(0,r.Z)({direction:"row",justifyContent:"center",alignItems:"center",sx:{borderRadius:d,backgroundColor:"grey.600",width:n||u,height:l||u,flexShrink:0}},f),i.createElement(s.D8x,{size:5}));if(g.success)return i.createElement(s.Kqy,(0,r.Z)({direction:"row",sx:{borderRadius:d,width:n||u,height:l||u,flexShrink:0}},f,{as:"img",src:(0,a.w)(e)}));if(g.error){const e=c(m);return t??i.createElement(s.Kqy,(0,r.Z)({direction:"row",justifyContent:"center",alignItems:"center",sx:{borderRadius:d,backgroundColor:"grey.600",width:n||u,height:l||u,flexShrink:0}},f),i.createElement(s.ZT$,{variant:"body2",sx:{fontWeight:"fontWeightSemibolds"}},e))}}},12463:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(45691),s=n(43023),a=n(67294),o=n(47886);function i(){const{pathname:e}=(0,o.TH)(),{network:t}=(0,s.g)(),n=(0,o.k6)();return(0,a.useCallback)((({token:s,address:a,options:o,amount:i})=>{(o?.replace?n.replace:n.push)({pathname:o?.path??e,search:`?${new URLSearchParams({tokenSymbol:s?.symbol||t?.networkToken.symbol||"",tokenAddress:s?.type===r.iv.ERC20?s?.address:"",amount:i??"",address:a??""}).toString()}`})}),[n,t?.networkToken.symbol,e])}},64670:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SendPage:()=>_e});var r=n(67294),s=n(1336),a=n(72250),o=n(27641),i=n(2409),d=n(43023),u=n(49530),c=n(45691),l=n(26793),m=n(70582),f=n(68483),g=n(13673),h=n(22127),v=n(9830),p=n(17223),x=n(59700),E=n(51260),A=n(51489),k=n(7278),S=n(87502),C=n(12463),N=n(12430),T=n(93302),w=n.n(T),b=n(48637),I=n(21104),y=n(79554);function P(e,t=!0){try{if(t){const[t]=b.P6.parse(e);if(!["X","P","C"].includes(t))return!1}else b.P6.parseBech32(e);return!0}catch(e){return!1}}n(23482),n(37786),n(2153),n(45538),n(30246);class F extends I.${constructor(e,t,n,r,s){if(super(s),this.addressC=e,this.addressCoreEth=t,this.xpAddresses=n,this.xpChangeAddress=r,n.length<1)throw new Error("Must have at least 1 xp address.");if(!(0,y.UJ)(e))throw new Error("Not a valid C-Chain (EVM) address");if(n.some((e=>!P(e,!1))))throw new Error("Given addresses must be valid avalanche bech32 addresses without the chain alias prefix");if(!P(t,!1))throw new Error("Given CoreEth address must be valid avalanche bech32 addresses without the chain alias prefix");this.setChangeAddress(r)}setChangeAddress(e){if(!P(e,!1))throw new Error("Given address must be valid avalanche bech32 addresses without the chain alias prefix");this.xpChangeAddress=e}getAddressEVM(){return this.addressC}getAddresses(e){return("C"===e?[this.addressCoreEth]:this.xpAddresses).map((t=>this.provider.formatAddress(t,e)))}getChangeAddress(e){const t="C"===e?this.addressCoreEth:this.xpChangeAddress;return this.provider.formatAddress(t,e)}getCurrentAddress(e){const t="C"===e?this.addressCoreEth:this.xpAddresses[0];return this.provider.formatAddress(t,e)}}var B=n(45524),R=n(81637),V=n(4563),D=n(64631),O=n(12756),L=n(21529),M=n(31759),_=n(69518),U=n(26821),K=n(19849);const{isStakeableLockOut:X,isTransferOut:H}=b.P6,W=e=>{const t=e.output,n=e.getOutputOwners();return{utxoId:e.ID(),assetId:e.getAssetId(),amount:H(t)||X(t)?t.amount():BigInt(0),locktime:n.locktime.value(),stakeableLocktime:X(t)?t.getStakeableLocktime():BigInt(0),threshold:n.threshold.value()}};var q=n(54876),Z=n(23085).lW,z=(e=>(e[e.AddValidator=0]="AddValidator",e[e.AddDelegator=1]="AddDelegator",e[e.ExportP=2]="ExportP",e[e.ImportP=3]="ImportP",e[e.AddPermissionlessValidator=4]="AddPermissionlessValidator",e[e.AddPermissionlessDelegator=5]="AddPermissionlessDelegator",e[e.BaseP=6]="BaseP",e[e.ConsolidateP=7]="ConsolidateP",e))(z||{});const $="NodeID-8TArWpFgH3sazEH8qP4gUjtGtFMvjw1aR",G="11111111111111111111111111111111LpoYY",j=(e,t)=>e.reduce(((e,t)=>e+W(t).amount),BigInt(0))-t,Q={6:{sortFunction:K.OX,unsignedTxBuilder:(e,t)=>{const n=e.getProvider().getContext();return e.baseTX(new b.P6.UtxoSet(t),"P",e.getCurrentAddress("P"),{[n.avaxAssetID]:j(t,n.baseTxFee)})}},7:{sortFunction:K.fR,unsignedTxBuilder:(e,t)=>{const n=e.getProvider().getContext();return e.consolidateP(new b.P6.UtxoSet(t),j(t,n.baseTxFee))}},4:{sortFunction:K.OT,unsignedTxBuilder:(e,t)=>e.addPermissionlessValidator(new b.P6.UtxoSet(t),$,(0,q.P)(),(0,q.P)()+BigInt(1e3),j(t,e.getProvider().getContext().addPrimaryNetworkValidatorFee),G,5,void 0,void 0,void 0,Z.from(b.P6.hexToBuffer("0x8f95423f7142d00a48e1014a3de8d28907d420dc33b3052a6dee03a3f2941a393c2351e354704ca66a3fc29870282e15")),Z.from(b.P6.hexToBuffer("0x86a3ab4c45cfe31cae34c1d06f212434ac71b1be6cfe046c80c162e057614a94a5bc9f1ded1a7029deb0ba4ca7c9b71411e293438691be79c2dbf19d1ca7c3eadb9c756246fc5de5b7b89511c7d7302ae051d9e03d7991138299b5ed6a570a98")))},5:{sortFunction:K.OT,unsignedTxBuilder:(e,t)=>e.addPermissionlessDelegator(new b.P6.UtxoSet(t),$,(0,q.P)(),(0,q.P)()+BigInt(1e3),j(t,e.getProvider().getContext().addPrimaryNetworkDelegatorFee),G)},1:{sortFunction:K.OT,unsignedTxBuilder:(e,t)=>e.addDelegator(new b.P6.UtxoSet(t),$,j(t,e.getProvider().getContext().addPrimaryNetworkDelegatorFee),(0,q.P)(),(0,q.P)()+BigInt(1e3))},0:{sortFunction:K.OT,unsignedTxBuilder:(e,t)=>e.addValidator(new b.P6.UtxoSet(t),$,j(t,e.getProvider().getContext().addPrimaryNetworkValidatorFee),(0,q.P)(),(0,q.P)()+BigInt(1e3),5)},2:{sortFunction:K.OX,unsignedTxBuilder:(e,t)=>e.exportP(j(t,e.getProvider().getContext().baseTxFee),new b.P6.UtxoSet(t),"X")},3:{sortFunction:K.OX,unsignedTxBuilder:(e,t)=>e.importP(new b.P6.UtxoSet(t),"X")}},J=65536;function Y(e,t){const n=e.getAssetDict()[t],r={locked:BigInt(0),available:BigInt(0),multisig:BigInt(0),lockedStakeable:BigInt(0),total:BigInt(0)};if(!n)return r;const s=n.getUTXOs(),a=(0,q.P)();return s.forEach((e=>{const t=W(e);r[t.threshold>1?"multisig":t.locktime>a?"locked":t.stakeableLocktime>a?"lockedStakeable":"available"]+=t.amount})),r.total=r.locked+r.lockedStakeable+r.multisig+r.available,r}var ee=n(25439),te=n(62334),ne=n(25108),re=function(e){return e.P="P",e.X="X",e}(re||{});async function se(e,t,n,r){const s=(0,te.B)(r)?re.P:re.X,a=await n.getUTXOs(s);let o=K.Mu(a.getUTXOs(),!0);if((0,te.B)(r))try{o=function(e,t,n,r=J){const{sortFunction:s,unsignedTxBuilder:a}=Q[n],o=s(t),i=function(e,t,n){let r=0,s=e.length-1;if(t(e)<=n)return s;let a=-1;for(;r<=s;){const o=Math.floor((r+s)/2);t(e.slice(0,o+1))<=n?(a=o,r=o+1):s=o-1}return a}(o,(t=>function(e){const t=e.getInputUtxos().reduce(((e,t)=>e+(8+65*W(t).threshold)),0);return 6+e.toBytes().length+t}(a(e,t))),r);return-1===i?[]:o.slice(0,i+1)}(n,a.getUTXOs(),z.BaseP,e?ee.ET:void 0)}catch(e){ne.error("Error calculating maximum utxo set",{e,txType:z.BaseP,utxos:a})}o=e?o.slice(0,64):o;const i=new b.P6.UtxoSet(o);return{utxos:i,balance:Y(i,t.getAvaxID())}}var ae=n(23085).lW,oe=n(72698),ie=n(91507),de=n(23085).lW,ue=n(96663),ce=n(88451),le=n(13550),me=n.n(le),fe=n(71446),ge=n(61359),he=n(2642),ve=n(87729),pe=n(20930),xe=n(67294);const Ee=[O.R.INSUFFICIENT_BALANCE_FOR_FEE,O.R.ADDRESS_REQUIRED,O.R.INVALID_ADDRESS],Ae=({address:e,inputAmount:t,token:n,isValid:s,isValidating:a,isSending:i,maxAmount:d,error:u,onAmountChanged:c,onContactChanged:m,onTokenChanged:g,onSend:h,tokenList:v})=>{const{t:p}=(0,l.$)(),x=(0,ve.e)(),E=(0,r.useMemo)((()=>e?x(e):void 0),[e,x]),[A,k]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1),{capture:N}=(0,o.O)(),{sendTokenSelectedAnalytics:T,sendAmountEnteredAnalytics:w}=(0,ge.t)(),b=(0,r.useRef)(null);return xe.createElement(f.Kqy,{sx:{flexGrow:1,alignItems:"center",width:"100%",pt:1}},xe.createElement(f.$B7,{style:{flexGrow:1,maxHeight:"unset",height:"100%"}},xe.createElement(f.Kqy,{ref:b},xe.createElement(he.d,{contact:E,onChange:(e,t)=>{m(e),N("SendContactSelected",{contactSource:t})},isContactsOpen:A,setIsOpen:e=>k(e),containerRef:b}),xe.createElement(f.Kqy,{sx:{pl:2,mt:.5,width:"100%",height:2}},(u===O.R.ADDRESS_REQUIRED||u===O.R.INVALID_ADDRESS)&&xe.createElement(f.ZT$,{variant:"caption",sx:{color:e=>e.palette.error.main}},(0,pe.Z)(u))),xe.createElement(f.Kqy,{sx:{py:0,px:2,mt:4,width:"100%"}},xe.createElement(fe.H,{maxAmount:d?new(me())(d):void 0,tokensList:v,selectedToken:n,onTokenChange:e=>{g(e),T("Send")},inputAmount:t,onInputAmountChange:({amount:e})=>{c(e),w("Send")},onSelectToggle:()=>{C((e=>!e))},isOpen:S,error:u&&(Ee.includes(u)?void 0:(0,pe.Z)(u)),setIsOpen:e=>C(e)})))),!A&&!S&&xe.createElement(f.Kqy,{sx:{flexGrow:1,justifyContent:"flex-end",pt:3,px:2,pb:3,width:"100%",alignItems:"center"}},xe.createElement(f.ua7,{placement:"top",sx:{width:"100%"},title:u?xe.createElement(f.ZT$,{variant:"body2"},(0,pe.Z)(u)):""},xe.createElement(f.zxk,{"data-testid":"send-next-button",variant:"contained",size:"large",onClick:h,disabled:a||!s||i,isLoading:i,fullWidth:!0},p("Next")))))};var ke=n(67294);const Se=({network:e,fromAddress:t,maxFee:n,nativeToken:s,provider:a,tokenList:o,onSuccess:i,onFailure:d,onApproved:u})=>{const l=(0,C.E)(),m=(0,A.K)(),f=o.find((e=>e.type===c.iv.ERC20?e.address===m.get("tokenAddress"):e.type===c.iv.NATIVE?e.symbol===m.get("tokenSymbol"):void 0)),g=(0,N.j)(k.At),[h,v]=(0,r.useState)(g),[p,x]=(0,r.useState)(f),[T,w]=(0,r.useState)(m.get("amount")??""),{error:b,isSending:I,isValid:y,isValidating:P,maxAmount:F,send:B,validate:R}=(0,oe.N)({chainId:`0x${e.chainId.toString(16)}`,from:t,maxFee:n,nativeToken:s,provider:a});(0,r.useEffect)((()=>{R({address:h,token:p,amount:T}),(h||p||T)&&l({address:h,token:p,amount:T,options:{replace:!0}})}),[h,T,p,R,l]);const V=(0,r.useCallback)((async()=>{if(!y)return;const{isApproved:e,hasError:t,result:n,error:r}=await(0,S.E)(B({address:h,token:p,amount:T}));e&&(u(),t?d(r):i(n))}),[h,T,y,u,d,i,B,p]),D=(0,r.useMemo)((()=>T?(0,E.J)(T,p?.decimals??18):void 0),[p,T]);return ke.createElement(Ae,{address:h,inputAmount:D,token:p,tokenList:o,onContactChanged:e=>v(e?.address??""),onAmountChanged:e=>w(e),onTokenChanged:e=>x(e),isSending:I,isValid:y,isValidating:P,error:b,maxAmount:F,onSend:V})};var Ce=n(65979),Ne=n(72295),Te=n(47886),we=n(80089),be=n(67294);const Ie=({network:e,fromAddress:t,maxFee:n,nativeToken:s,provider:a,tokenList:o,onSuccess:i,onFailure:d,onApproved:u})=>{const c=(0,C.E)(),l=(0,r.useCallback)((t=>(0,we.l)(t,!e.isTestnet)),[e.isTestnet]),m=(0,N.j)(l),[f,g]=(0,r.useState)(m),[h,v]=(0,r.useState)(""),{error:p,isSending:x,isValid:A,isValidating:k,maxAmount:T,send:w,validate:b}=(({isMainnet:e,from:t,provider:n,maxFee:s,nativeToken:a})=>{const{request:o}=(0,_.K)(),[i,d]=(0,r.useState)(!1),[u,c]=(0,r.useState)(!1),[l,m]=(0,r.useState)([]),[f,g]=(0,r.useState)("0"),[h,v]=(0,r.useState)();(0,r.useEffect)((()=>{let e=!0;return(0,ce.RL)(n,a,Number(s)).then((t=>{e&&m(t)})).catch((()=>{v(O.R.UNABLE_TO_FETCH_UTXOS)})),()=>{e=!1}}),[n,a,s]);const p=(0,r.useCallback)((async n=>{const{address:r,amount:o}=n;c(!0),v(void 0);try{const n=(0,E.J)(o||"0",a.decimals).toNumber(),i=Math.max((0,ue.L)(l,r,t,Number(s)),0);g(i.toString());const d=(0,ce.Af)(t,{address:r,amount:n,feeRate:Number(s),token:a},l,e);if(d)return void v(d);v(void 0)}finally{c(!1)}}),[l,s,t,e,a]);return{error:h,isSending:i,isValid:!h,isValidating:u,maxAmount:f,send:(0,r.useCallback)((async({address:e,amount:t})=>{d(!0);try{const n=(0,E.J)(t||"0",a.decimals).toNumber();return o({method:M.e.BITCOIN_SEND_TRANSACTION,params:[e,String(n),Number(s)]})}finally{d(!1)}}),[s,a.decimals,o]),validate:p}})({isMainnet:!e.isTestnet,from:t,maxFee:n,provider:a,nativeToken:s});(0,r.useEffect)((()=>{s&&(b({address:f,amount:h}),f&&c({token:s,address:f,amount:h,options:{replace:!0}}))}),[f,h,b,c,s]);const I=(0,r.useCallback)((async()=>{if(!A)return;const{isApproved:e,hasError:t,result:n,error:r}=await(0,S.E)(w({address:f,amount:h}));e&&(u(),t?d(r):i(n))}),[f,h,A,u,d,i,w]),y=(0,r.useMemo)((()=>h?(0,E.J)(h,s?.decimals??8):void 0),[s,h]);return be.createElement(Ae,{address:f,inputAmount:y,token:s,tokenList:o,onContactChanged:e=>g(e?.addressBTC??""),onAmountChanged:e=>v(e),onTokenChanged:()=>{},isSending:x,isValid:A,isValidating:k,error:p,maxAmount:T,onSend:I})};var ye=n(51931),Pe=n(14479),Fe=n(67294);const Be=({network:e,fromAddress:t,maxFee:n,nativeToken:s,provider:a,tokenList:o,account:i,onSuccess:d,onFailure:u,onApproved:c})=>{const l=(0,C.E)(),m=(0,A.K)(),[f,h]=(0,r.useState)(m.get("address")??""),[v,p]=(0,r.useState)(""),{error:x,isSending:N,isValid:T,isValidating:I,maxAmount:y,send:P,validate:B}=(({network:e,provider:t,account:n,maxFee:s})=>{const{request:a}=(0,_.K)(),{featureFlags:o}=(0,U.d)(),{isLedgerWallet:i}=(0,D.t)(),[d,u]=(0,r.useState)(),[c,l]=(0,r.useState)(!1),[m,f]=(0,r.useState)(!1),[g,h]=(0,r.useState)("0"),v=(0,r.useMemo)((()=>new F(n.addressC,(0,L.z)(n.addressCoreEth),[(0,L.z)(n.addressPVM)],(0,L.z)(n.addressPVM),t)),[n,t]),p=(0,r.useCallback)((()=>{if(!o[V.yy.SEND_P_CHAIN])return O.R.SEND_NOT_AVAILABLE}),[o]);function x(e){u(e),l(!1)}const E=(0,r.useCallback)((async n=>{const{address:r,token:a,amount:o}=n,d=o||"0";l(!0),u(void 0);const c=p();if(c)return x(c);const[m,f]=await(0,ie.D)(se(i,t,v,e));if(f)return x(O.R.UNABLE_TO_FETCH_UTXOS);const g=(0,R.W)(w()(d),a.decimals),E=(m?.balance.available??BigInt(0))-s;return h(E.toString()),r?(0,k.N9)(r)?o&&"0"!==o?E<BigInt(0)||g>E?x(O.R.INSUFFICIENT_BALANCE):(l(!1),void u(void 0)):x(O.R.AMOUNT_REQUIRED):x(O.R.INVALID_ADDRESS):x(O.R.ADDRESS_REQUIRED)}),[p,i,s,e,t,v]);return{error:d,isSending:m,isValid:!c&&!d,isValidating:c,maxAmount:g,send:(0,r.useCallback)((async({address:r,token:s,amount:o})=>{p(),f(!0);try{const{utxos:d}=await se(i,t,v,e),u=t.getAvaxID(),c=(0,R.W)(w()(o),s.decimals),l=b.P6.parse(n.addressPVM)[2],m=v.baseTX(d,"P",r,{[u]:c},{changeAddresses:[l]}),f=b.P6.getManagerForVM(m.getVM()),[g]=f.getCodecFromBuffer(m.toBytes()),h={transactionHex:de.from(m.toBytes()).toString("hex"),chainAlias:"P",utxos:m.utxos.map((e=>b.P6.bufferToHex(e.toBytes(g))))};return a({method:M.e.AVALANCHE_SEND_TRANSACTION,params:h})}finally{f(!1)}}),[n,p,i,e,t,a,v]),validate:E}})({network:e,from:t,maxFee:n,provider:a,nativeToken:s,account:i});(0,r.useEffect)((()=>{B({address:f,token:s,amount:v}),(f||v)&&l({address:f,token:s,amount:v,options:{replace:!0}})}),[f,v,B,l,s,i,o]);const K=(0,r.useCallback)((async()=>{if(!T)return;const{isApproved:e,hasError:t,result:n,error:r}=await(0,S.E)(P({address:f,token:s,amount:v}));e&&(c(),t?u(r):d(n))}),[f,v,T,s,c,u,d,P]),X=(0,r.useMemo)((()=>v?(0,E.J)(v,s?.decimals??18):void 0),[s,v]);return i&&!i.addressPVM?Fe.createElement(Pe.Y,{functionName:g.o.TOKEN_DETAILS,network:e?.chainName||"Testnet"}):Fe.createElement(Ae,{address:f,inputAmount:X,token:s,tokenList:o,onContactChanged:e=>{e?.addressXP&&h(e.addressXP)},onAmountChanged:e=>p(e),onTokenChanged:()=>{},isSending:N,isValid:T,isValidating:I,error:x,maxAmount:y,onSend:K})};var Re=n(67294);const Ve=({network:e,fromAddress:t,maxFee:n,nativeToken:s,provider:a,tokenList:o,account:i,onSuccess:d,onFailure:u,onApproved:c})=>{const l=(0,C.E)(),m=(0,A.K)(),[f,h]=(0,r.useState)(m.get("address")??""),[v,p]=(0,r.useState)(""),{error:x,isSending:N,isValid:T,isValidating:I,maxAmount:y,send:P,validate:K}=(({network:e,provider:t,account:n,maxFee:s})=>{const{request:a}=(0,_.K)(),{featureFlags:o}=(0,U.d)(),{isLedgerWallet:i}=(0,D.t)(),[d,u]=(0,r.useState)(),[c,l]=(0,r.useState)(!1),[m,f]=(0,r.useState)(!1),[g,h]=(0,r.useState)("0"),v=(0,r.useMemo)((()=>new F(n.addressC,(0,L.z)(n.addressCoreEth),[(0,L.z)(n.addressAVM)],(0,L.z)(n.addressAVM),t)),[n,t]),p=(0,r.useCallback)((()=>{if(!o[V.yy.SEND_X_CHAIN])return O.R.SEND_NOT_AVAILABLE}),[o]);function x(e){u(e),l(!1)}const E=(0,r.useCallback)((async n=>{const{address:r,token:a,amount:o}=n,d=o||"0";l(!0),u(void 0);const c=p();if(c)return x(c);const[m,f]=await(0,B.D)(se(i,t,v,e));if(f)return x(O.R.UNABLE_TO_FETCH_UTXOS);const g=(m?.balance.available??BigInt(0))-s,E=(0,R.W)(w()(d),a.decimals),A=g.toString();return h(A),r?(0,k.ZG)(r)?o&&"0"!==o?g<BigInt(0)||E>g?x(O.R.INSUFFICIENT_BALANCE):(u(void 0),void l(!1)):x(O.R.AMOUNT_REQUIRED):x(O.R.INVALID_ADDRESS):x(O.R.ADDRESS_REQUIRED)}),[p,i,s,e,t,v]);return{error:d,isSending:m,isValid:!d,isValidating:c,maxAmount:g,send:(0,r.useCallback)((async({address:r,token:s,amount:o})=>{p(),f(!0);try{const d=await se(i,t,v,e),u=t.getAvaxID(),c=(0,R.W)(w()(o),s.decimals),l=b.P6.parse(n.addressAVM)[2],m=v.baseTX(d.utxos,"X",r,{[u]:c},{changeAddresses:[l]}),f=b.P6.getManagerForVM(m.getVM()),[g]=f.getCodecFromBuffer(m.toBytes()),h={transactionHex:ae.from(m.toBytes()).toString("hex"),chainAlias:"X",utxos:m.utxos.map((e=>b.P6.bufferToHex(e.toBytes(g))))};return a({method:M.e.AVALANCHE_SEND_TRANSACTION,params:h})}finally{f(!1)}}),[n,p,i,e,t,a,v]),validate:E}})({network:e,from:t,maxFee:n,provider:a,nativeToken:s,account:i});(0,r.useEffect)((()=>{K({address:f,token:s,amount:v}),f&&l({token:s,address:f,options:{replace:!0}})}),[f,v,K,l,s,i]);const X=(0,r.useCallback)((async()=>{if(!T)return;const{isApproved:e,hasError:t,result:n,error:r}=await(0,S.E)(P({address:f,token:s,amount:v}));e&&(c(),t?u(r):d(n))}),[f,v,T,s,c,u,d,P]),H=(0,r.useMemo)((()=>v?(0,E.J)(v,s?.decimals??9):void 0),[s,v]);return i&&!i.addressAVM?Re.createElement(Pe.Y,{functionName:g.o.TOKEN_DETAILS,network:e?.chainName||"Testnet"}):Re.createElement(Ae,{address:f,inputAmount:H,token:s,tokenList:o,onContactChanged:e=>{e?.addressXP&&h(e.addressXP)},onAmountChanged:e=>p(e),onTokenChanged:()=>{},isSending:N,isValid:T,isValidating:I,error:x,maxAmount:y,onSend:X})};var De=n(23246);const Oe=e=>Boolean(e&&e.addressAVM&&e.addressCoreEth),Le=e=>Boolean(e&&e.addressPVM&&e.addressCoreEth);var Me=n(67294);function _e(){const{t:e}=(0,l.$)(),t=(0,Te.k6)(),{network:n}=(0,d.g)(),{networkFee:E}=(0,p.Y)(),{accounts:{active:A}}=(0,v.a)(),{captureEncrypted:k}=(0,o.O)(),S=(0,a._)(!1),{isFunctionAvailable:C,isFunctionSupported:N}=(0,g.a)(g.o.SEND),T=S.find((({type:e})=>e===c.iv.NATIVE)),w=(0,r.useMemo)((()=>n?(0,x.f)(n):void 0),[n]),b=(0,r.useMemo)((()=>n?.vmName===u.mK.EVM?A?.addressC??"":n?.vmName===u.mK.BITCOIN?A?.addressBTC??"":(0,De.n)(n)?A?.addressAVM??"":(0,te.B)(n)?A?.addressPVM??"":""),[A?.addressAVM,A?.addressBTC,A?.addressC,A?.addressPVM,n]),I=(0,r.useCallback)((r=>{k("SendSuccessful",{address:b,txHash:r,chainId:n?.chainId}),(0,Ce.E)({title:e("Send Successful"),url:(0,Ne.tf)(n,r),label:e("View in Explorer")}),t.push("/home")}),[b,n,k,t,e]),y=(0,r.useCallback)((()=>{m.ZP.error(e("Transaction Failed")),k("SendFailed",{address:b,chainId:n?.chainId})}),[k,b,n?.chainId,e]),P=(0,r.useCallback)((()=>{k("SendApproved",{address:b,chainId:n?.chainId})}),[k,b,n?.chainId]);if(!N)return Me.createElement(h.n,{functionName:g.o.SEND,network:n?.chainName||"Testnet"});if(!C)return Me.createElement(i.F,{functionName:g.o.SEND});const F=(0,te.B)(n)||(0,De.n)(n)?!!w:!!E?.low?.maxFee,B=!(A&&n&&b&&w&&F&&T);return Me.createElement(f.Kqy,{sx:{width:"100%",height:"100%"}},Me.createElement(s.V,null,e("Send")),B&&Me.createElement(ye.Z,null),!B&&n.vmName===u.mK.EVM&&E&&Me.createElement(Se,{network:n,fromAddress:b,maxFee:E.low.maxFee,nativeToken:T,provider:w,tokenList:S,onSuccess:I,onFailure:y,onApproved:P}),!B&&n.vmName===u.mK.BITCOIN&&E&&Me.createElement(Ie,{network:n,fromAddress:b,maxFee:E.low.maxFee,nativeToken:T,provider:w,tokenList:S,onSuccess:I,onFailure:y,onApproved:P}),!B&&n.vmName===u.mK.PVM&&Le(A)&&Me.createElement(Be,{network:n,fromAddress:b,maxFee:w.getContext().baseTxFee,nativeToken:T,provider:w,tokenList:S,account:A,onSuccess:I,onFailure:y,onApproved:P}),!B&&n.vmName===u.mK.AVM&&Oe(A)&&Me.createElement(Ve,{network:n,fromAddress:b,maxFee:w.getContext().baseTxFee,nativeToken:T,provider:w,tokenList:S,account:A,onSuccess:I,onFailure:y,onApproved:P}))}},80089:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var r=n(5927);function s(e,t){return(0,r.KZ)(e,t)||(0,r.ce)(e,t)}},88451:(e,t,n)=>{"use strict";n.d(t,{Af:()=>c,RL:()=>d,oT:()=>u});var r=n(38490),s=n(96663),a=n(39789),o=n(80089),i=n(12756);const d=async(e,t,n)=>{const r=await e.getScriptsForUtxos(t.utxos??[]);return"number"==typeof n?r.filter((e=>(0,a.inputBytes)(e)*n<e.value)):r},u=async(e,t,{amount:n,address:s,token:a,feeRate:o})=>{const i=await d(t,a);return(0,r.O)(s,e,n,o,i,t.getNetwork())},c=(e,{address:t,amount:n,feeRate:r},a,d)=>t?r?(0,o.l)(t,d)?!n||n<=0?i.R.AMOUNT_REQUIRED:n>Math.max((0,s.L)(a,t,e,r),0)?i.R.INSUFFICIENT_BALANCE:null:i.R.INVALID_ADDRESS:i.R.INVALID_NETWORK_FEE:i.R.ADDRESS_REQUIRED},3030:(e,t,n)=>{var r=n(39789);e.exports=function(e,t,n){if(!isFinite(r.uintOrNaN(n)))return{};for(var s=r.transactionBytes([],t),a=0,o=[],i=r.sumOrNaN(t),d=0;d<e.length;++d){var u=e[d],c=r.inputBytes(u),l=n*c,m=r.uintOrNaN(u.value);if(l>u.value){if(d===e.length-1)return{fee:n*(s+c)}}else if(s+=c,a+=m,o.push(u),!(a<i+n*s))return r.finalize(o,t,n)}return{fee:n*s}}},37037:(e,t,n)=>{var r=n(39789);e.exports=function(e,t,n){if(!isFinite(r.uintOrNaN(n)))return{};for(var s=r.transactionBytes([],t),a=0,o=[],i=r.sumOrNaN(t),d=r.dustThreshold({},n),u=0;u<e.length;++u){var c=e[u],l=r.inputBytes(c),m=n*(s+l),f=r.uintOrNaN(c.value);if(!(a+f>i+m+d||(s+=l,a+=f,o.push(c),a<i+m)))return r.finalize(o,t,n)}return{fee:n*s}}},92213:(e,t,n)=>{var r=n(3030),s=n(37037),a=n(39789);function o(e,t){return e.value-t*a.inputBytes(e)}e.exports=function(e,t,n){e=e.concat().sort((function(e,t){return o(t,n)-o(e,n)}));var a=s(e,t,n);return a.inputs?a:r(e,t,n)}},39789:e=>{var t=41,n=107,r=9,s=25;function a(e){return t+(e.script?e.script.length:n)}function o(e){return r+(e.script?e.script.length:s)}function i(e,t){return a({})*t}function d(e,t){return 10+e.reduce((function(e,t){return e+a(t)}),0)+t.reduce((function(e,t){return e+o(t)}),0)}function u(e){return"number"!=typeof e?NaN:isFinite(e)?Math.floor(e)!==e||e<0?NaN:e:NaN}function c(e){return e.reduce((function(e,t){return e+u(t.value)}),0)}var l=o({});e.exports={dustThreshold:i,finalize:function(e,t,n){var r=d(e,t),s=n*(r+l),a=c(e)-(c(t)+s);a>i(0,n)&&(t=t.concat({value:a}));var o=c(e)-c(t);return isFinite(o)?{inputs:e,outputs:t,fee:o}:{fee:n*r}},inputBytes:a,outputBytes:o,sumOrNaN:c,sumForgiving:function(e){return e.reduce((function(e,t){return e+(isFinite(t.value)?t.value:0)}),0)},transactionBytes:d,uintOrNaN:u}}}]);
//# debugId=ecfcfd2e-047d-5c90-9d7b-c217f350b365
