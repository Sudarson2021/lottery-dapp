"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="f2e2c27a-6bbf-53c0-8b11-1442d45e5dcd")}catch(e){}}();
(self.webpackChunkavalanche_extension=self.webpackChunkavalanche_extension||[]).push([[2020],{32738:(e,t,a)=>{a.d(t,{Uc:()=>r,VI:()=>i,X0:()=>o});var n=a(93e3);const r=e=>e?.type===n.Qm.FIREBLOCKS,i=e=>e?.type===n.Qm.WALLET_CONNECT,o=e=>e?.type===n.Qm.PRIMARY},19108:(e,t,a)=>{function n(e){return Boolean(e?.addressBTC)}a.d(t,{Z:()=>n})},2409:(e,t,a)=>{a.d(t,{F:()=>m,e:()=>l});var n=a(1336),r=a(36609),i=a(68483),o=a(26793),s=a(13673),c=a(67294);function l(e){return{[s.o.BRIDGE]:(0,r.t)("Bridge"),[s.o.SWAP]:(0,r.t)("Swap"),[s.o.SEND]:(0,r.t)("Send"),[s.o.BUY]:(0,r.t)("Buy"),[s.o.DEFI]:(0,r.t)("DeFi"),[s.o.KEYSTONE]:(0,r.t)("Keystone"),[s.o.TOKEN_DETAILS]:(0,r.t)("Token Details")}[e]}function m({functionName:e,hidePageTitle:t,children:a}){const{t:r}=(0,o.$)();return c.createElement(i.Kqy,{sx:{height:"100%",width:"100%"}},!t&&c.createElement(n.V,{variant:n.D.PRIMARY},r("Sorry")),c.createElement(i.Kqy,{sx:{alignItems:"center",justifyContent:"center",flexGrow:1}},c.createElement(i.go2,{size:72,sx:{mb:3,mt:-9}}),c.createElement(i.ZT$,{variant:"h5",sx:{mb:1}},r("Feature Disabled")),c.createElement(i.ZT$,{size:16,align:"center",height:"24px",sx:{color:"text.secondary"}},r("{{functionName}} is currently unavailable.",{functionName:l(e)??r("This Feature")})),c.createElement(i.ZT$,{sx:{color:"text.secondary"}},r("Please check back later and try again.")),a))}},13673:(e,t,a)=>{a.d(t,{o:()=>y,a:()=>k});var n=a(49530),r=a(32738),i=a(4563),o=a(19108),s=a(9830),c=a(43023),l=a(93e3),m=a(36553),d=a(64631);var E=a(26821),p=a(62334),u=a(23246);let y=function(e){return e.BRIDGE="Bridge",e.BUY="Buy",e.COLLECTIBLES="COLLECTIBLES",e.DEFI="DeFi",e.FEATURE="Feature",e.KEYSTONE="Keystone",e.MANAGE_TOKEN="ManageTokens",e.RECEIVE="Receive",e.SEND="Send",e.SWAP="Swap",e.SIGN="Sign",e.TOKEN_DETAILS="TokenDetails",e}({});const x={[y.BRIDGE]:i.yy.BRIDGE,[y.BUY]:i.yy.BUY,[y.DEFI]:i.yy.DEFI,[y.KEYSTONE]:i.yy.KEYSTONE,[y.SEND]:i.yy.SEND,[y.SWAP]:i.yy.SWAP},f=[y.BRIDGE,y.SEND,y.SWAP,y.SIGN],g=(e,t)=>!![n.a_.BITCOIN,n.a_.BITCOIN_TESTNET].includes(e)&&(!Boolean(t.addressBTC)||(0,r.VI)(t)||(0,r.Uc)(t)&&!(0,o.Z)(t)),T=(e,t)=>{const a=(0,p.p)(e),n=(0,u.v)(e);if(!a&&!n)return!1;const i=Boolean(t.addressPVM),o=Boolean(t.addressAVM);return a&&!i||n&&!o||(0,r.VI)(t)||(0,r.Uc)(t)},h={ManageTokens:{networks:[n.a_.BITCOIN,n.a_.AVALANCHE_P,n.a_.AVALANCHE_TEST_P,n.a_.AVALANCHE_X,n.a_.AVALANCHE_TEST_X],complexChecks:[]},Receive:{networks:[],complexChecks:[g,T]},Send:{networks:[],complexChecks:[g,T]},Bridge:{networks:[n.a_.AVALANCHE_P,n.a_.AVALANCHE_TEST_P,n.a_.AVALANCHE_X,n.a_.AVALANCHE_TEST_X,n.a_.DFK,n.a_.DFK_TESTNET,n.a_.SWIMMER,n.a_.SWIMMER_TESTNET],complexChecks:[g]}},v={COLLECTIBLES:[n.a_.AVALANCHE_MAINNET_ID,n.a_.AVALANCHE_TESTNET_ID,n.a_.ETHEREUM_HOMESTEAD],Swap:[n.a_.AVALANCHE_MAINNET_ID],Buy:[n.a_.AVALANCHE_MAINNET_ID,n.a_.AVALANCHE_TESTNET_ID]},k=e=>{const{network:t}=(0,c.g)(),a=(()=>{const{walletDetails:e}=(0,d.t)(),{accounts:{active:t}}=(0,s.a)();return e?.type===m.Y.Seedless&&t?.type===l.Qm.PRIMARY})(),{featureFlags:n}=(0,E.d)(),{accounts:{active:r}}=(0,s.a)(),o=Boolean(t&&r),g=e=>{if(a&&f.includes(e)&&!n[i.yy.SEEDLESS_SIGNING])return!1;if(e===y.SEND){if((0,p.B)(t))return Boolean(!!r?.addressPVM&&n[i.yy.SEND]&&n[i.yy.SEND_P_CHAIN]);if((0,u.n)(t))return Boolean(!!r?.addressAVM&&n[i.yy.SEND]&&n[i.yy.SEND_X_CHAIN])}const o=x[e];return!o||n[o]},T=e=>{if(!t||!r)return!1;const a=(0,p.B)(t)&&!r.addressPVM,n=(0,u.n)(t)&&!r.addressAVM;if(e===y.SEND&&(a||n))return!1;if(v[e]&&!v[e].includes(t.chainId))return!1;const i=h[e];if(i){const e=i.networks.includes(t.chainId),a=i.complexChecks.some((e=>e(t.chainId,r)));return!e&&!a}return!0};return t&&r&&e?{isReady:o,isFunctionAvailable:g(e??y.FEATURE),isFunctionSupported:T(e),checkIsFunctionSupported:T,checkIsFunctionAvailable:g}:{isReady:o,isFunctionAvailable:!1,isFunctionSupported:!1,checkIsFunctionSupported:T,checkIsFunctionAvailable:g}}},72020:(e,t,a)=>{a.r(t),a.d(t,{DefiProtocolDetails:()=>R});var n=a(67294),r=a(47886),i=a(26793),o=a(68483),s=a(40652),c=a(59466),l=a(2409),m=a(26821),d=a(1336),E=a(72473),p=a(72881),u=a(43101),y=a(67294);const x=({items:e})=>{const{t}=(0,i.$)();return y.createElement(o.Kqy,{sx:{gap:3}},e.map((({supplyTokens:e,borrowTokens:a,rewardTokens:n},r)=>y.createElement(o.Kqy,{key:`defi-lending-${r}`,sx:{gap:2}},e.length>0&&y.createElement(f,{tokens:e,headers:[t("Supplied"),t("Value")]}),a.length>0&&y.createElement(f,{tokens:a,headers:[t("Borrowed")]}),n.length>0&&y.createElement(f,{tokens:n,headers:[t("Rewards")]})))))},f=({headers:e,tokens:t})=>{const a=(0,u.N)();return y.createElement(o.Kqy,{sx:{gap:1.25},"data-testid":"defi-lending-section"},y.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between"}},e.map((e=>y.createElement(o.ZT$,{key:e,variant:"button"},e)))),t.map((e=>y.createElement(o.Kqy,{key:e.symbol,direction:"row",sx:{gap:1,justifyContent:"space-between"},"data-testid":"defi-item"},y.createElement(o.Kqy,{direction:"row",sx:{gap:1}},y.createElement(o.qEK,{key:e.symbol,src:e.logoUrl,alt:e.name,sx:{width:16,height:16},"data-testid":"defi-item-token-avatar"}),y.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-token-list"},e.symbol)),y.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-value"},a(e.usdValue))))))};var g=a(91793);const T=(e,t)=>e.reduce(((e,a,n)=>{const r=a[t];return"number"==typeof r?e+r:((0,g.aY)(`sumByProperty(): object at index ${n} was ignored. Property ${String(t)} does not contain a number:`,a),e)}),0);var h=a(87462),v=a(67294);const k={imgProps:{loading:"lazy"},sx:{width:16,height:16}},w=({tokens:e,maxTokens:t,...a})=>{const r=(0,n.useMemo)((()=>16+8*(Math.min(3,t)-1)),[t]);return v.createElement(o.HEJ,(0,h.Z)({},a,{max:3,sx:{width:r,gap:.5,justifyContent:"start",display:"inline-flex"},slotProps:{additionalAvatar:{...k,style:{fontSize:"9px"}}}}),e.map((e=>v.createElement(o.qEK,(0,h.Z)({},k,{"data-testid":"defi-item-token-avatar",key:e.symbol,src:e.logoUrl,alt:e.name})))))};var S=a(67294);const A=({items:e,header:t})=>{const{t:a}=(0,i.$)(),r=(0,u.N)(),s=(0,n.useMemo)((()=>Math.max(...e.map((e=>e.supplyTokens?.length??0)))),[e]);return S.createElement(o.Kqy,{sx:{gap:1.25}},S.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between"}},S.createElement(o.ZT$,{variant:"button"},t),S.createElement(o.ZT$,{variant:"button"},a("Value"))),S.createElement(o.Kqy,{sx:{gap:2}},e.map((({supplyTokens:e=[],rewardTokens:t=[]},n)=>{const i=t.length>0,c=r(T(e,"usdValue")),l=r(T(t,"usdValue")),m=e.map((({symbol:e})=>e)).join(" + ");return S.createElement(o.Kqy,{key:`defi-common-${n}`,direction:"row",sx:{gap:1,justifyContent:"space-between"},"data-testid":"defi-item"},S.createElement(o.Kqy,{direction:"row",sx:{gap:1,width:1,alignItems:"flex-start"}},S.createElement(w,{tokens:e,maxTokens:s}),S.createElement(o.Kqy,{sx:{gap:.5,flexGrow:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},S.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between",gap:1}},S.createElement(o.ZT$,{title:m,variant:"caption",noWrap:!0,"data-testid":"defi-item-token-list"},m),S.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-value"},c)),i&&S.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between",gap:1}},S.createElement(o.ZT$,{variant:"caption",color:"text.secondary"},a("Rewards")),S.createElement(o.ZT$,{variant:"caption",color:"text.secondary","data-testid":"defi-item-rewards-value"},l)))))}))))};var N=a(67294);const I=({items:e})=>{const{t}=(0,i.$)(),a=(0,u.N)(),r=(0,n.useMemo)((()=>e.reduce(((e,t)=>Math.max(e,t.tokens.length??0)),0)),[e]);return N.createElement(o.Kqy,{sx:{gap:1.25}},N.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between"}},N.createElement(o.ZT$,{variant:"button"},t("Pool")),N.createElement(o.ZT$,{variant:"button"},t("Value"))),e.map((({tokens:e,netUsdValue:t},n)=>{const i=e.map((({symbol:e})=>e)).join(" + ");return N.createElement(o.Kqy,{key:`defi-rewards-${n}`,direction:"row",sx:{gap:1,justifyContent:"space-between"},"data-testid":"defi-item"},N.createElement(o.Kqy,{direction:"row",sx:{gap:1,alignItems:"center"}},N.createElement(w,{maxTokens:r,tokens:e}),N.createElement(o.Kqy,{sx:{gap:.5,flexGrow:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},N.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between",gap:1}},N.createElement(o.ZT$,{title:i,variant:"caption",noWrap:!0,"data-testid":"defi-item-token-list"},i),N.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-value"},a(t))))))})))};var b=a(67294);const K=({items:e})=>{const{t}=(0,i.$)(),a=(0,u.N)();return b.createElement(o.Kqy,{sx:{gap:1.25}},b.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between"}},b.createElement(o.ZT$,{variant:"button"},t("Pool")),b.createElement(o.ZT$,{variant:"button"},t("Value"))),e.map((({token:e,netUsdValue:t},n)=>b.createElement(o.Kqy,{key:`defi-vesting-${n}`,direction:"row",sx:{gap:1,justifyContent:"space-between"},"data-testid":"defi-item"},b.createElement(o.Kqy,{direction:"row",sx:{gap:1,alignItems:"flex-start"}},b.createElement(o.qEK,{sx:{width:16,height:16},src:e.logoUrl,alt:e.name,"data-testid":"defi-item-token-avatar"}),b.createElement(o.Kqy,{sx:{gap:.5}},b.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-token-list"},e.symbol))),b.createElement(o.Kqy,{sx:{gap:.5,textAlign:"end"}},b.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-value"},a(t)))))))};var C=a(67294);const _=({items:e})=>{const{t}=(0,i.$)(),a=(0,u.N)();return C.createElement(o.Kqy,{sx:{gap:1.25}},C.createElement(o.Kqy,{direction:"row",sx:{justifyContent:"space-between"}},C.createElement(o.ZT$,{variant:"button"},t("Description")),C.createElement(o.ZT$,{variant:"button"},t("Value"))),C.createElement(o.Kqy,{sx:{gap:2}},e.map((({description:e,netUsdValue:t},n)=>C.createElement(o.Kqy,{key:`defi-insurance-${n}`,direction:"row",sx:{gap:2,justifyContent:"space-between"},"data-testid":"defi-item"},C.createElement(o.ua7,{title:e,wrapWithSpan:!1},C.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-description",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e)),C.createElement(o.Kqy,{sx:{gap:.5,textAlign:"end"}},C.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-value"},a(t))))))))};var $=a(67294);const q=({sx:e,...t})=>$.createElement(o.rjZ,(0,h.Z)({item:!0,sx:[{display:"inline-flex",alignItems:"center"},...Array.isArray(e)?e:[e]]},t)),D=({items:e})=>{const{t}=(0,i.$)(),a=(0,u.N)();return $.createElement(o.Kqy,{sx:{gap:1.25}},$.createElement(o.rjZ,{container:!0,spacing:1},$.createElement(o.rjZ,{container:!0,item:!0,spacing:1},$.createElement(q,{xs:5},$.createElement(o.ZT$,{variant:"button"},t("Token Pair"))),$.createElement(q,{xs:3},$.createElement(o.ZT$,{variant:"button"},t("PnL"))),$.createElement(q,{xs:4,sx:{justifyContent:"end"}},$.createElement(o.ZT$,{variant:"button"},t("Value")))),e.map((({marginToken:e,positionToken:t,profitUsdValue:n,netUsdValue:r},i)=>$.createElement(o.rjZ,{container:!0,item:!0,spacing:1,key:`defi-perpetual-${i}`,"data-testid":"defi-item",sx:{alignItems:"center"}},$.createElement(q,{xs:5,sx:{gap:.5}},$.createElement(w,{tokens:[t,e],maxTokens:2}),$.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-token-pair"},t.symbol,"/",e.symbol)),$.createElement(q,{xs:3},$.createElement(o.ZT$,{variant:"caption"},a(n))),$.createElement(q,{xs:4,sx:{justifyContent:"end"}},$.createElement(o.ZT$,{variant:"caption","data-testid":"defi-item-value"},a(r))))))))};var Z=a(67294);const V=({group:e})=>{const{t}=(0,i.$)(),a=(0,n.useMemo)((()=>"Rewards"===e.name?t("Pool"):t("Supplied")),[e.name,t]),r=(0,n.useMemo)((()=>e.items.reduce(((e,t)=>(e[t.type]?e[t.type].push(t):e[t.type]=[t],e)),{})),[e]);return Z.createElement(o.Kqy,{sx:{gap:2},"data-testid":"defi-protocol-group"},Z.createElement(o.Kqy,{sx:{pt:1,justifyContent:"center"}},Z.createElement(o.ZT$,{variant:"h6","data-testid":"defi-protocol-group-name"},t(e.name))),Z.createElement(o.Kqy,{sx:{gap:2,pb:2}},Object.entries(r).map((([e,t])=>{const n=`defi-group-${e}`;switch(e){case p.S.Lending:return Z.createElement(x,{key:n,items:t});case p.S.Reward:return Z.createElement(I,{key:n,items:t});case p.S.Vesting:return Z.createElement(K,{key:n,items:t});case p.S.InsuranceBuyer:return Z.createElement(_,{key:n,items:t});case p.S.Perpetual:return Z.createElement(D,{key:n,items:t});default:return Z.createElement(A,{key:n,header:a,items:t})}}))))};var B=a(67294);const F=({protocol:e})=>{const t=(0,u.N)(),a=(0,n.useCallback)((()=>{e?.siteUrl&&(0,s.RB)({url:e?.siteUrl})}),[e]);return B.createElement(o.Kqy,{direction:"row",sx:{alignItems:"start",gap:2,pt:2,pb:1}},B.createElement(o.qEK,{src:e.logoUrl,alt:e.name,sx:{mt:.5}}),B.createElement(o.Kqy,{sx:{gap:1,justifyContent:"space-between"}},B.createElement(o.ZT$,{variant:"h4","data-testid":"defi-protocol-header-name"},e.name),e.chainId&&B.createElement(o.Kqy,{direction:"row",sx:{gap:.75,alignItems:"center"}},B.createElement(o.qEK,{src:e.chainLogoUrl,alt:e.chainName,sx:{width:12,height:12}}),B.createElement(o.ZT$,{variant:"caption",color:"text.secondary","data-testid":"defi-protocol-header-chain"},e.chainName))),B.createElement(o.Kqy,{sx:{alignItems:"flex-end",flexGrow:1}},B.createElement(o.ZT$,{variant:"button",sx:{fontSize:14},"data-testid":"defi-protocol-header-value"},t(e.totalUsdValue)),B.createElement(o.hU,{component:"a",size:"small",sx:{mr:-.5},onClick:a,"data-testid":"defi-protocol-header-dapp-link"},B.createElement(o.h0n,{size:16}))))};var M=a(4563),L=a(13673),P=a(67294);function R(){const{protocolId:e}=(0,r.UO)(),{t}=(0,i.$)(),a=(0,r.k6)(),{featureFlags:p}=(0,m.d)(),{hasError:u,isLoading:y,portfolio:x,refresh:f}=(0,c.M)(),g=x?.protocols?.find((t=>t.id===e))??null,T=(0,n.useCallback)((()=>{g?.siteUrl&&(0,s.RB)({url:g?.siteUrl})}),[g]);return(0,n.useEffect)(f,[f]),p[M.yy.DEFI]?P.createElement(o.Kqy,{sx:{pt:1,pb:2,px:2,flexGrow:1,width:"100%",alignItems:"center"}},y&&!g&&P.createElement(o.D8x,{sx:{mt:9},size:100}),u&&P.createElement(E.f,null),g&&P.createElement(P.Fragment,null,P.createElement(d.V,{variant:d.D.SECONDARY,margin:"8px 0 8px -24px"}),P.createElement(o.Zbd,{sx:{width:1,overflow:"initial",flexGrow:1}},P.createElement(o.aYP,{sx:{px:2,py:0,height:"100%",":last-child":{pb:0}}},P.createElement(o.Kqy,{sx:{height:"100%"}},P.createElement(F,{protocol:g}),P.createElement(o.izJ,{sx:{my:1}}),P.createElement(o.$B7,null,0===g.groups.length?P.createElement(o.Kqy,{sx:{mt:5,gap:1,alignItems:"center"},"data-testid":"defi-protocol-emptied-state"},P.createElement(o.ZT$,{variant:"body2",color:"text.secondary"},t("No Transactions Found")),P.createElement(o.zxk,{variant:"text",size:"small",onClick:()=>a.replace("/home?activeTab=DEFI"),sx:{mt:1}},t("Go Back to DeFi Portfolio"))):P.createElement(o.Kqy,{sx:{gap:1},divider:P.createElement(o.izJ,null),"data-testid":"defi-protocol-groups"},g.groups.map((e=>P.createElement(V,{key:e.name,group:e})))),P.createElement(o.xuv,{sx:{width:1,height:40}})," ")))),P.createElement(o.Kqy,{sx:{width:1,flexShrink:0,pt:2,pb:1,justifyContent:"flex-end"}},P.createElement(o.zxk,{fullWidth:!0,size:"large",onClick:T,startIcon:P.createElement(o.h0n,{size:16}),"data-testid":"defi-protocol-dapp-button"},t("Go to {{protocolName}}",{protocolName:g.name}))))):P.createElement(l.F,{hidePageTitle:!0,functionName:L.o.DEFI})}},72473:(e,t,a)=>{a.d(t,{f:()=>s});var n=a(87462),r=a(26793),i=a(68483),o=a(67294);const s=e=>{const{t}=(0,r.$)();return o.createElement(i.Kqy,(0,n.Z)({sx:{mt:9,gap:1,alignItems:"center"}},e),o.createElement(i.go2,{size:60,sx:{mb:2}}),o.createElement(i.ZT$,{variant:"h5"},t("Error!")),o.createElement(i.ZT$,{variant:"body2",color:"text.secondary"},t("Data currently unavailable, check back later.")))}},43101:(e,t,a)=>{a.d(t,{N:()=>s});var n=a(67294),r=a(71526),i=a(96505),o=a(23170);const s=(e="USD")=>{const{convert:t,hasExchangeRate:a}=(0,r.T)(),{currency:s,currencyFormatter:c}=(0,i.K)(),l=(0,n.useMemo)((()=>(0,o.k)(e)),[e]),m=(0,n.useMemo)((()=>a(e,s)),[e,s,a])&&s!==e;return(0,n.useMemo)((()=>m?a=>{const n=t({amount:a,from:e,to:s});return c(n)}:l),[t,c,l,m,e,s])}}}]);
//# debugId=f2e2c27a-6bbf-53c0-8b11-1442d45e5dcd
