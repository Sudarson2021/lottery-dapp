"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="aee11baa-78ce-587e-9151-7d95f4e123d8")}catch(e){}}();
(self.webpackChunkavalanche_extension=self.webpackChunkavalanche_extension||[]).push([[8589],{2409:(e,t,a)=>{a.d(t,{F:()=>E,e:()=>l});var n=a(1336),r=a(36609),i=a(68483),o=a(26793),c=a(13673),s=a(67294);function l(e){return{[c.o.BRIDGE]:(0,r.t)("Bridge"),[c.o.SWAP]:(0,r.t)("Swap"),[c.o.SEND]:(0,r.t)("Send"),[c.o.BUY]:(0,r.t)("Buy"),[c.o.DEFI]:(0,r.t)("DeFi"),[c.o.KEYSTONE]:(0,r.t)("Keystone"),[c.o.TOKEN_DETAILS]:(0,r.t)("Token Details")}[e]}function E({functionName:e,hidePageTitle:t,children:a}){const{t:r}=(0,o.$)();return s.createElement(i.Kqy,{sx:{height:"100%",width:"100%"}},!t&&s.createElement(n.V,{variant:n.D.PRIMARY},r("Sorry")),s.createElement(i.Kqy,{sx:{alignItems:"center",justifyContent:"center",flexGrow:1}},s.createElement(i.go2,{size:72,sx:{mb:3,mt:-9}}),s.createElement(i.ZT$,{variant:"h5",sx:{mb:1}},r("Feature Disabled")),s.createElement(i.ZT$,{size:16,align:"center",height:"24px",sx:{color:"text.secondary"}},r("{{functionName}} is currently unavailable.",{functionName:l(e)??r("This Feature")})),s.createElement(i.ZT$,{sx:{color:"text.secondary"}},r("Please check back later and try again.")),a))}},44531:(e,t,a)=>{a.d(t,{y:()=>o});var n=a(2734),r=a(68483),i=a(67294);const o=({children:e,label:t})=>{const a=(0,n.Z)();return i.createElement(r.Kqy,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"baseline",gap:1}},i.createElement(r.ZT$,{variant:"caption",color:"text.secondary"},t),i.createElement(r.Kqy,{sx:{flexDirection:"row",alignItems:"center",gap:1,minHeight:a.spacing(2),minWidth:"0px",wordWrap:"break-word"}},e))}},67383:(e,t,a)=>{a.d(t,{R:()=>l});var n=a(67294),r=a(82135),i=a(92094),o=a(60917),c=a(70582),s=a(85466);function l({onApprove:e,onReject:t,pendingMessage:a,showPending:l}){const E=(0,r.Z)(),u=(0,i.Z)(),d=(0,o.Z)(),m=(0,s.Z)(),p=d||m,y=E||u||d||m,[A,T]=(0,n.useState)(!p),[S,h]=(0,n.useState)(!1),N=(0,n.useRef)("");return{isApprovalOverlayVisible:S,handleApproval:(0,n.useCallback)((async()=>{if(h(y),!p||A){if(a&&!y&&l){const e=c.ZP.loading(a);N.current=e}await e(),N.current&&c.ZP.dismiss(N.current),h(!1)}else T(!0)}),[y,p,A,a,l,e]),handleRejection:(0,n.useCallback)((async()=>{h(!1),p&&T(!1),await t()}),[p,t])}}},24479:(e,t,a)=>{a.d(t,{v:()=>E});var n=a(46935),r=a(5453),i=a(69518),o=a(95034),c=a(67294),s=a(23900),l=a(2606);function E(e){const{request:t}=(0,i.K)(),a=(0,s.h)(s.A.CONFIRM),{approval:E}=(0,l.t$)(),[u,d]=(0,c.useState)(),[m]=(0,c.useState)(""),p=(0,c.useCallback)((async(e,i)=>{d((t=>{if(t)return{...t,status:e.status,displayData:{...t.displayData,...e.displayData}}}));const o=a&&e.status!==r.M4.PENDING;return t({method:n.a.ACTION_UPDATE,params:[e,i]}).finally((()=>{o&&globalThis.close()}))}),[t,a]),y=(0,c.useCallback)((async()=>p({status:r.M4.ERROR_USER_CANCELED,id:e})),[e,p]);return(0,c.useEffect)((()=>{a?t({method:n.a.ACTION_GET,params:[e]}).then(d):E?.action.actionId===e&&d(E.action)}),[e,t,E,a]),(0,o.W)(y),{action:u,updateAction:p,error:m,cancelHandler:y}}},70460:(e,t,a)=>{a.d(t,{$:()=>i});var n=a(67294),r=a(47886);function i(){const e=(0,r.TH)();return(0,n.useMemo)((()=>new URLSearchParams(e.search??"").get("actionId")??""),[e.search])}},13673:(e,t,a)=>{a.d(t,{o:()=>y,a:()=>x});var n=a(49530),r=a(32738),i=a(4563),o=a(19108),c=a(9830),s=a(43023),l=a(93e3),E=a(36553),u=a(64631);var d=a(26821),m=a(62334),p=a(23246);let y=function(e){return e.BRIDGE="Bridge",e.BUY="Buy",e.COLLECTIBLES="COLLECTIBLES",e.DEFI="DeFi",e.FEATURE="Feature",e.KEYSTONE="Keystone",e.MANAGE_TOKEN="ManageTokens",e.RECEIVE="Receive",e.SEND="Send",e.SWAP="Swap",e.SIGN="Sign",e.TOKEN_DETAILS="TokenDetails",e}({});const A={[y.BRIDGE]:i.yy.BRIDGE,[y.BUY]:i.yy.BUY,[y.DEFI]:i.yy.DEFI,[y.KEYSTONE]:i.yy.KEYSTONE,[y.SEND]:i.yy.SEND,[y.SWAP]:i.yy.SWAP},T=[y.BRIDGE,y.SEND,y.SWAP,y.SIGN],S=(e,t)=>!![n.a_.BITCOIN,n.a_.BITCOIN_TESTNET].includes(e)&&(!Boolean(t.addressBTC)||(0,r.VI)(t)||(0,r.Uc)(t)&&!(0,o.Z)(t)),h=(e,t)=>{const a=(0,m.p)(e),n=(0,p.v)(e);if(!a&&!n)return!1;const i=Boolean(t.addressPVM),o=Boolean(t.addressAVM);return a&&!i||n&&!o||(0,r.VI)(t)||(0,r.Uc)(t)},N={ManageTokens:{networks:[n.a_.BITCOIN,n.a_.AVALANCHE_P,n.a_.AVALANCHE_TEST_P,n.a_.AVALANCHE_X,n.a_.AVALANCHE_TEST_X],complexChecks:[]},Receive:{networks:[],complexChecks:[S,h]},Send:{networks:[],complexChecks:[S,h]},Bridge:{networks:[n.a_.AVALANCHE_P,n.a_.AVALANCHE_TEST_P,n.a_.AVALANCHE_X,n.a_.AVALANCHE_TEST_X,n.a_.DFK,n.a_.DFK_TESTNET,n.a_.SWIMMER,n.a_.SWIMMER_TESTNET],complexChecks:[S]}},f={COLLECTIBLES:[n.a_.AVALANCHE_MAINNET_ID,n.a_.AVALANCHE_TESTNET_ID,n.a_.ETHEREUM_HOMESTEAD],Swap:[n.a_.AVALANCHE_MAINNET_ID],Buy:[n.a_.AVALANCHE_MAINNET_ID,n.a_.AVALANCHE_TESTNET_ID]},x=e=>{const{network:t}=(0,s.g)(),a=(()=>{const{walletDetails:e}=(0,u.t)(),{accounts:{active:t}}=(0,c.a)();return e?.type===E.Y.Seedless&&t?.type===l.Qm.PRIMARY})(),{featureFlags:n}=(0,d.d)(),{accounts:{active:r}}=(0,c.a)(),o=Boolean(t&&r),S=e=>{if(a&&T.includes(e)&&!n[i.yy.SEEDLESS_SIGNING])return!1;if(e===y.SEND){if((0,m.B)(t))return Boolean(!!r?.addressPVM&&n[i.yy.SEND]&&n[i.yy.SEND_P_CHAIN]);if((0,p.n)(t))return Boolean(!!r?.addressAVM&&n[i.yy.SEND]&&n[i.yy.SEND_X_CHAIN])}const o=A[e];return!o||n[o]},h=e=>{if(!t||!r)return!1;const a=(0,m.B)(t)&&!r.addressPVM,n=(0,p.n)(t)&&!r.addressAVM;if(e===y.SEND&&(a||n))return!1;if(f[e]&&!f[e].includes(t.chainId))return!1;const i=N[e];if(i){const e=i.networks.includes(t.chainId),a=i.complexChecks.some((e=>e(t.chainId,r)));return!e&&!a}return!0};return t&&r&&e?{isReady:o,isFunctionAvailable:S(e??y.FEATURE),isFunctionSupported:h(e),checkIsFunctionSupported:h,checkIsFunctionAvailable:S}:{isReady:o,isFunctionAvailable:!1,isFunctionSupported:!1,checkIsFunctionSupported:h,checkIsFunctionAvailable:S}}},98589:(e,t,a)=>{a.r(t),a.d(t,{ApproveAction:()=>K});var n=a(31759),r=a(5453),i=a(24479),o=a(86658),c=a(70460),s=a(2074),l=a(67294),E=a(26793),u=a(68483),d=a(83694),m=a(44531),p=a(26993),y=a(32672),A=a(67294);const T=({token:e,amount:t,fiatValue:a})=>{const{t:n}=(0,E.$)(),r="string"==typeof a&&!a.includes("NaN");return A.createElement(u.Kqy,{sx:{flexDirection:"row",justifyContent:"space-between"}},A.createElement(u.Kqy,{sx:{flexDirection:"row",alignItems:"center",gap:2}},A.createElement(y.T,{src:e?.logoUri}),A.createElement(u.ZT$,{variant:"body1",sx:{fontWeight:"fontWeightSemibold"}},e?.symbol||n("Unknown"))),A.createElement(u.Kqy,{sx:{textAlign:"end",justifyContent:a?"space-between":"center"}},A.createElement(u.ZT$,{variant:"body2",component:"span",sx:{lineHeight:1}},t," ",e?.symbol||n("Unknown Symbol")),r&&A.createElement(u.ZT$,{variant:"caption",sx:{color:"text.secondary",lineHeight:1}},a)))};var S=a(93302),h=a.n(S),N=a(96505),f=a(50785),x=a(27641),I=a(43023),g=a(17223),v=a(67294);function _({action:e}){const{t}=(0,E.$)(),{currencyFormatter:a}=(0,N.K)(),{capture:n}=(0,x.O)(),{network:o}=(0,I.g)(),{networkFee:s}=(0,g.Y)(),y=(0,c.$)(),{updateAction:A}=(0,i.v)(y),{displayData:S}=e,[_,b]=(0,l.useState)({}),[w,C]=(0,l.useState)(f.Lm.INSTANT),D="number"==typeof S.token?.priceUSD?new(h())(S.amountStr).times(S.token.priceUSD):void 0,k=(0,l.useCallback)((t=>{b((a=>{const n=void 0!==t.maxFeePerGas&&t.maxFeePerGas!==a.maxFeePerGas,i=void 0!==t.maxPriorityFeePerGas&&t.maxPriorityFeePerGas!==a.maxPriorityFeePerGas;return n||i?(A({id:e.actionId,status:r.M4.PENDING,displayData:{gasSettings:t}}),{...a,...t}):a}))}),[b,e.actionId,A]);return v.createElement(u.Kqy,{sx:{flexGrow:1,width:1}},v.createElement(u.ZT$,{variant:"h4",sx:{mt:1.5,mb:3.5}},t("Bridge Approval")),v.createElement(d.p5,null,v.createElement(d._C,{label:t("Transaction Details")}),v.createElement(d.f1,{sx:{py:1,px:2,gap:1}},v.createElement(m.y,{label:t("App")},v.createElement(u.ZT$,{variant:"caption",sx:{textOverflow:"ellipsis",overflow:"hidden"}},e.site?.domain??"")),v.createElement(m.y,{label:t("From")},v.createElement(u.ZT$,{variant:"caption"},S.sourceNetwork?.chainName),v.createElement(p.A,{src:S.sourceNetwork?.logoUri,width:"16px",height:"16px",defaultSize:16})),v.createElement(m.y,{label:t("To")},v.createElement(u.ZT$,{variant:"caption"},S.targetNetwork?.chainName),v.createElement(p.A,{src:S.targetNetwork?.logoUri,width:"16px",height:"16px",defaultSize:16})))),v.createElement(d.p5,{sx:{my:2}},v.createElement(d._C,{label:t("Balance Change")}),v.createElement(d.f1,{sx:{p:2}},v.createElement(m.y,{label:t("Transaction Type")},v.createElement(u.ZT$,{variant:"caption"},t("Bridge"))),v.createElement(u.izJ,{sx:{mb:1}}),v.createElement(T,{token:S.token,amount:S.amountStr,fiatValue:D?a(D.toNumber()):""}))),v.createElement(f.a0,{isLimitReadonly:!0,maxFeePerGas:_.maxFeePerGas||0n,limit:Number(e.displayData.gasLimit)||0,onChange:e=>{k({maxFeePerGas:e.maxFeePerGas,maxPriorityFeePerGas:e.maxPriorityFeePerGas}),e.feeType&&C(e.feeType)},onModifierChangeCallback:e=>{e&&C(e),n("BridgeFeeOptionChanged",{modifier:e})},selectedGasFeeModifier:w,network:o,networkFee:s}))}var b=a(78888),w=a(83192),C=a(11532),D=a(82135),k=a(92094),F=a(19248),P=a(2734),R=a(60917),B=a(65124),L=a(67383),G=a(85466),M=a(35291),V=a(13673),Z=a(2409),H=a(67294);function K(){const{t:e}=(0,E.$)(),t=(0,P.Z)(),a=(0,c.$)(),{action:l,updateAction:m,cancelHandler:p}=(0,i.v)(a),{network:y}=(0,I.g)(),A=(0,D.Z)(),T=(0,k.Z)(),S=(0,R.Z)(),h=(0,G.Z)(),{isFunctionAvailable:N}=(0,V.a)(V.o.SIGN),{handleApproval:f,handleRejection:x,isApprovalOverlayVisible:g}=(0,L.R)({onApprove:async()=>{await m({status:r.M4.SUBMITTING,id:a},A||T||S||h)},onReject:p});return(0,w.a)((()=>x()),b.px.AVALANCHE,y),l?N?H.createElement(H.Fragment,null,H.createElement(u.Kqy,{sx:{width:1,px:2}},H.createElement(s.f,null,(()=>{if(g){if(A)return H.createElement(C.R,null);if(T)return H.createElement(F.o,{onReject:x});if(S)return H.createElement(B.m,{onSubmit:f,onReject:x});if(h)return H.createElement(M.A,{onSubmit:f,onReject:x})}})(),{[n.e.AVALANCHE_BRIDGE_ASSET]:H.createElement(_,{action:l})}[l.method||"unknown"],l.error&&H.createElement(d.p5,null,H.createElement(d._C,{label:e("Error")}),H.createElement(d.f1,{sx:{height:"105px",p:1}},H.createElement(o.ZP,{style:{flexGrow:1,maxHeight:"unset",height:"100%"}},H.createElement(u.Kqy,null,H.createElement(u.ZT$,{variant:"caption",sx:{color:t.palette.error.main,wordBreak:"break-all"}},l.error))))),H.createElement(u.Kqy,{sx:{flexDirection:"row",alignItems:"flex-end",width:"100%",justifyContent:"space-between",pt:3,pb:1,gap:1}},H.createElement(u.zxk,{color:"secondary","data-testid":"transaction-reject-btn",size:"large",fullWidth:!0,disabled:l.status===r.M4.SUBMITTING,onClick:x},e("Reject")),H.createElement(u.zxk,{"data-testid":"transaction-approve-btn",size:"large",fullWidth:!0,disabled:l.status===r.M4.SUBMITTING||!!l.error,onClick:f},e("Approve")))))):H.createElement(Z.F,{functionName:V.o.FEATURE,hidePageTitle:!0}):H.createElement(u.Kqy,{sx:{width:1,height:1,justifyContent:"center",alignItems:"center"}},H.createElement(u.D8x,null))}},11532:(e,t,a)=>{a.d(t,{R:()=>s});var n=a(68483),r=a(94277),i=a(82135),o=a(86642),c=a(67294);function s({to:e,contractAddress:t,fee:a,feeSymbol:s,amount:l,symbol:E}){return(0,i.Z)()?c.createElement(r.a,{isBackgroundFilled:!0},c.createElement(n.Kqy,{sx:{width:1,height:1,alignItems:"center",justifyContent:"center"}},c.createElement(o.q,{address:t||e,fee:a,feeSymbol:s,amount:l,symbol:E}))):null}},95034:(e,t,a)=>{a.d(t,{W:()=>s});var n=a(67294),r=a(83),i=a(45399),o=a(94975),c=a(73335);function s(e){(0,n.useEffect)((()=>{const t=(0,r.T)((0,i.R)((e=>{window.addEventListener("unload",e)}),(e=>{window.removeEventListener("unload",e)})),(0,i.R)((e=>{window.addEventListener("visibilitychange",e)}),(e=>{window.removeEventListener("visibilitychange",e)})).pipe((0,o.h)((()=>"hidden"===document.visibilityState)))).pipe((0,c.P)()).subscribe((()=>{e()}));return()=>{t.unsubscribe()}}),[e])}}}]);
//# debugId=aee11baa-78ce-587e-9151-7d95f4e123d8
