"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3c1bc1ca-7c37-57cf-8333-4b7e16357784")}catch(e){}}();
(self.webpackChunkavalanche_extension=self.webpackChunkavalanche_extension||[]).push([[8756],{37113:(e,t,n)=>{n.d(t,{L:()=>s,h:()=>l});var a=n(87462),r=n(2734),o=n(68483),i=n(67294);const c=({...e})=>{const t=(0,r.Z)();return i.createElement(o.v4q,(0,a.Z)({size:20,sx:{".MuiSelect-icon":{transition:"transform 150ms ease-in-out",right:t.spacing(2),top:"calc(50% - 10px)"},".MuiSelect-iconOpen":{transform:"rotateX(180deg)"}}},e))},s=({children:e,...t})=>{const n=(0,r.Z)(),{SelectProps:s,InputProps:l,...d}=(({InputProps:{sx:e={},...t}={},SelectProps:{MenuProps:{PaperProps:{sx:n={},...a}={},...o}={},...i}={},...s})=>{const l=(0,r.Z)();return{InputProps:{sx:{padding:0,height:l.spacing(6),border:`1px solid ${l.palette.grey[800]}`,backgroundColor:l.palette.grey[850],fontSize:l.typography.body1.fontSize,"&.Mui-focused":{backgroundColor:l.palette.grey[850]},".MuiOutlinedInput-notchedOutline, &:hover .MuiOutlinedInput-notchedOutline":{border:"none"},".MuiOutlinedInput-input":{padding:l.spacing(1.5,2)},...e},...t},SelectProps:{IconComponent:c,MenuProps:{PaperProps:{sx:{border:`1px solid ${l.palette.grey[850]}`,maxWidth:343,maxHeight:144,mt:2,...n},...a},...o},...i},...s}})(t);return i.createElement(o.PhF,(0,a.Z)({variant:"outlined",InputProps:l,SelectProps:s,inputLabelProps:{sx:{transform:"none",fontSize:n.typography.body2.fontSize}}},d),e)},l=({sx:e,children:t,...n})=>{const c=(0,r.Z)();return i.createElement(o.sNh,(0,a.Z)({sx:{minHeight:"auto",height:c.spacing(5),fontSize:c.typography.body2.fontSize,gap:1,...e}},n),t)}},30825:(e,t,n)=>{n.d(t,{H:()=>o});var a=n(90948),r=n(68483);const o=(0,a.ZP)(r.Kqy)`
  width: 80px;
  height: 80px;
  background-color: ${({theme:e})=>e.palette.background.paper};
  justify-content: center;
  align-items: center;
  border-radius: 50%;
  margin: ${({margin:e})=>e??"8px 0"};
`},32672:(e,t,n)=>{n.d(t,{T:()=>u});var a=n(87462),r=n(68483),o=n(57832),i=n(67294),c=n(67294);const s="50%",l="32px",d=e=>{const t=(e||"").split(" "),n=t[0],a=t[t.length-1];return n&&a?n.substring(0,1)+a.substring(0,1):n?n.substring(0,1):""};function u({src:e,children:t,width:n,height:u,name:p,...m}){const[h,g]=(0,i.useState)();if((0,i.useEffect)((()=>{let t=!1;return new Promise(((t,n)=>{if(!e)return void n("no source value");const a=document.createElement("img");a.onerror=e=>{n(e)},a.onload=()=>{t(a)},a.src=(0,o.w)(e)})).then((()=>{!t&&g({success:!0})})).catch((()=>{!t&&g({error:!0})})),()=>{t=!0}}),[p,e]),!h)return c.createElement(r.Kqy,(0,a.Z)({direction:"row",justifyContent:"center",alignItems:"center",sx:{borderRadius:s,backgroundColor:"grey.600",width:n||l,height:u||l,flexShrink:0}},m),c.createElement(r.D8x,{size:5}));if(h.success)return c.createElement(r.Kqy,(0,a.Z)({direction:"row",sx:{borderRadius:s,width:n||l,height:u||l,flexShrink:0}},m,{as:"img",src:(0,o.w)(e)}));if(h.error){const e=d(p);return t??c.createElement(r.Kqy,(0,a.Z)({direction:"row",justifyContent:"center",alignItems:"center",sx:{borderRadius:s,backgroundColor:"grey.600",width:n||l,height:u||l,flexShrink:0}},m),c.createElement(r.ZT$,{variant:"body2",sx:{fontWeight:"fontWeightSemibolds"}},e))}}},24479:(e,t,n)=>{n.d(t,{v:()=>d});var a=n(46935),r=n(5453),o=n(69518),i=n(95034),c=n(67294),s=n(23900),l=n(2606);function d(e){const{request:t}=(0,o.K)(),n=(0,s.h)(s.A.CONFIRM),{approval:d}=(0,l.t$)(),[u,p]=(0,c.useState)(),[m]=(0,c.useState)(""),h=(0,c.useCallback)((async(e,o)=>{p((t=>{if(t)return{...t,status:e.status,displayData:{...t.displayData,...e.displayData}}}));const i=n&&e.status!==r.M4.PENDING;return t({method:a.a.ACTION_UPDATE,params:[e,o]}).finally((()=>{i&&globalThis.close()}))}),[t,n]),g=(0,c.useCallback)((async()=>h({status:r.M4.ERROR_USER_CANCELED,id:e})),[e,h]);return(0,c.useEffect)((()=>{n?t({method:a.a.ACTION_GET,params:[e]}).then(p):d?.action.actionId===e&&p(d.action)}),[e,t,d,n]),(0,i.W)(g),{action:u,updateAction:h,error:m,cancelHandler:g}}},37411:(e,t,n)=>{n.d(t,{t:()=>o});var a=n(99295),r=n(67294);function o(e){const{getTotalBalance:t}=(0,a.j)();return(0,r.useMemo)((()=>e?.addressC?t(e.addressC):null),[e?.addressC,t])}},70460:(e,t,n)=>{n.d(t,{$:()=>o});var a=n(67294),r=n(47886);function o(){const e=(0,r.TH)();return(0,a.useMemo)((()=>new URLSearchParams(e.search??"").get("actionId")??""),[e.search])}},28756:(e,t,n)=>{n.r(t),n.d(t,{PermissionsPage:()=>$});var a=n(67294),r=n(2734),o=n(68483),i=n(9830),c=n(32672),s=n(74247),l=n(24479),d=n(30825),u=n(5453),p=n(70460),m=n(26793),h=n(23900),g=n(37113),y=n(99295),x=n(96505),E=n(37411),f=n(56693),b=n(67294);const w=e=>b.createElement(o.ZT$,{component:"span",fontSize:"inherit",sx:{display:"flex",flex:1,minWidth:0}},b.createElement(o.ZT$,{component:"span",noWrap:!0,fontSize:"inherit"},e.name),b.createElement(o.ZT$,{component:"span",sx:{flexShrink:0,pl:.5},fontSize:"inherit"},"(",(0,f.F)(e.addressC),")")),v=({accounts:e,activeAccount:t,onSelectedAccountChanged:n})=>{const i=(0,r.Z)(),{t:c}=(0,m.$)(),[s,l]=(0,a.useState)(t),[d,u]=(0,a.useState)(!1),{updateBalanceOnAllNetworks:p}=(0,y.j)(),{currency:h,currencyFormatter:f}=(0,x.K)(),v=(0,E.t)(s),C=v?.sum||0,S=v&&null!==v&&null!==v.sum;return(0,a.useEffect)((()=>{s?(async()=>{u(!0),await(p?.(s)),u(!1)})():t&&l(t)}),[t,s,p]),(0,a.useEffect)((()=>{n(s)}),[n,s]),b.createElement(o.Kqy,{sx:{gap:1,width:"100%"}},b.createElement(g.L,{SelectProps:{defaultValue:e.find((e=>e.id===t?.id)),onChange:e=>l(e.target.value),renderValue:w,"data-testid":"connect-account-dropdown"},label:c("Select Account")},e.map((e=>b.createElement(g.h,{key:e.id,value:e,selected:s?.id===e.id,"data-testid":"connect-account-menu-item",title:e.name},w(e),s?.id===e.id&&b.createElement(o.nQG,null))))),d&&b.createElement(o.OdW,{variant:"text",width:120}),!d&&S&&b.createElement(o.ZT$,{variant:"caption",color:i.palette.text.secondary},c("Balance"),": ",f(C).replace(h,"")))};var C=n(59368),S=n(3132),k=n(54725),P=n(26821),A=n(4563),Z=n(45524),T=n(35698),I=n(25108),z=n(67294);function $(){const{t:e}=(0,m.$)(),t=(0,p.$)(),{permissions:n,isDomainConnectedToAccount:g}=(0,s.H)(),y=(0,r.Z)(),{accounts:{active:x},allAccounts:E}=(0,i.a)(),[f,b]=(0,a.useState)(),[w,$]=(0,a.useState)(void 0),[M,D]=(0,a.useState)(!0),K=(0,h.h)(h.A.CONFIRM),q=function(){const{featureFlags:e}=(0,P.d)();return(0,a.useCallback)((async t=>{if(!e[A.yy.BLOCKAID_DAPP_SCAN])return;const n=new T.ZP({baseURL:"https://proxy-api.avax.network/proxy/blockaid/",apiKey:"key"}),[a,r]=await(0,Z.D)(n.site.scan({url:t}));if(null===a||r)throw new Error("There is an error during requesting the dApp data");return"miss"===a.status?{status:a.status}:{status:a.status,url:a.url||t,isMalicious:a.is_malicious}}),[e])}(),{featureFlags:R}=(0,P.d)(),{action:N,cancelHandler:j,updateAction:O}=(0,l.v)(t),W=N?.status===u.M4.SUBMITTING,_="eth_requestAccounts"===N?.method,L="wallet_requestPermissions"===N?.method;(0,a.useEffect)((()=>{N?.site?.domain&&q(N.site.domain).then((e=>{$(e)})).catch((e=>I.error(e)))}),[q,N?.site?.domain]);const B=(0,a.useCallback)((async()=>{f&&O({status:u.M4.SUBMITTING,id:t,result:f.id})}),[f,O,t]),H=(0,a.useMemo)((()=>N&&x&&g(N.displayData.domainUrl,x.addressC)&&K),[N,x,g,K]);if((0,a.useEffect)((()=>{H&&_&&(x?.id?O({status:u.M4.SUBMITTING,id:t,result:x.id}):window.close())}),[x?.id,H,_,t,O]),!n||!N||H&&!L)return z.createElement(o.xgg,{size:20});const U=w&&w.isMalicious,F=!(!w||"miss"!==w?.status);return z.createElement(z.Fragment,null,z.createElement(o.Kqy,{sx:{width:"100%",px:2,color:y.palette.text.primary,justifyContent:"space-between"}},z.createElement(o.Kqy,{sx:{gap:3,py:1.5}},z.createElement(o.xuv,{sx:{width:"100%"}},z.createElement(o.ZT$,{variant:"h4"},e("Connect Core to Dapp"))),z.createElement(o.Kqy,{sx:{gap:2.5,alignItems:"center"}},R[A.yy.BLOCKAID_DAPP_SCAN]&&U&&z.createElement(S.e,{title:e("Malicious Application"),text:e("This application is malicious, do not proceed.")}),R[A.yy.BLOCKAID_DAPP_SCAN_WARNING]&&F&&z.createElement(k.X,{title:e("Suspicious Application"),text:e("Use caution, this application may be malicious.")}),z.createElement(d.H,{sx:{m:0}},z.createElement(c.T,{height:"48px",width:"48px",src:N.displayData.domainIcon},z.createElement(o.n9J,{size:48,color:y.palette.text.secondary}))),z.createElement(o.Kqy,{sx:{gap:.5,textAlign:"center",maxWidth:1}},z.createElement(o.ZT$,{variant:"h5"},N.displayData.domainName),z.createElement(o.ZT$,{sx:{fontSize:12,color:y.palette.text.secondary,wordWrap:"break-word"}},N.displayData.domainUrl))),z.createElement(v,{accounts:E,activeAccount:x,onSelectedAccountChanged:e=>b(e)})),z.createElement(o.Kqy,{sx:{width:"100%",justifyContent:"space-between",textAlign:"center"}},z.createElement(o.ZT$,{variant:"caption",sx:{mb:2,color:y.palette.text.secondary},paragraph:!0},e("Only connect to sites that you trust.")),z.createElement(o.Kqy,{sx:{flexDirection:"row",justifyContent:"space-between",width:"100%",gap:1}},z.createElement(o.zxk,{color:"secondary","data-testid":"connect-reject-btn",onClick:()=>{j(),window.close()},fullWidth:!0,size:"large",disabled:W},e("Reject")),z.createElement(o.zxk,{"data-testid":"connect-approve-btn",onClick:()=>B(),fullWidth:!0,size:"large",isLoading:W,disabled:W},W?"":e("Approve"))))),R[A.yy.BLOCKAID_DAPP_SCAN]&&U&&z.createElement(C.a,{cancelHandler:()=>{j(),window.close()},open:M,onClose:()=>D(!1),title:e("Scam Application"),text:e("This application is malicious, do not proceed."),rejectLabel:e("Reject Connection")}))}},3132:(e,t,n)=>{n.d(t,{e:()=>i});var a=n(2734),r=n(68483),o=n(67294);function i({title:e,text:t}){const n=(0,a.Z)();return o.createElement(r.bZj,{severity:"error",icon:o.createElement(r.RBH,{size:24,color:n.palette.common.black}),sx:{backgroundColor:"error.light",borderColor:"transparent",px:2,color:"common.black",width:"100%"}},o.createElement(r.BZi,null,o.createElement(r.ZT$,{variant:"caption",sx:{fontWeight:600,display:"block"}},e),o.createElement(r.ZT$,{variant:"caption",sx:{display:"block"}},t)))}},59368:(e,t,n)=>{n.d(t,{a:()=>c});var a=n(2734),r=n(68483),o=n(26793),i=n(67294);function c({cancelHandler:e,open:t,onClose:n,title:c,text:s,rejectLabel:l}){const d=(0,a.Z)(),{t:u}=(0,o.$)();return i.createElement(r.VqE,{open:t,showCloseIcon:!0,onClose:n,PaperProps:{sx:{m:2,width:1,height:1,maxWidth:"none",position:"relative"}}},i.createElement(r.Kqy,{sx:{py:3,px:5,alignItems:"center",justifyContent:"space-between",height:"100%"}},i.createElement(r.Kqy,{sx:{alignItems:"center",justifyContent:"center",textAlign:"center",width:"225px",gap:1.5,py:14}},i.createElement(r.RBH,{size:48,color:d.customPalette.avalancheRed}),i.createElement(r.ZT$,{sx:{color:d.customPalette.avalancheRed,px:2},variant:"h4"},c),i.createElement(r.ZT$,{variant:"body2"},s)),i.createElement(r.Kqy,{sx:{alignItems:"center",width:"100%",gap:1}},i.createElement(r.zxk,{color:"primary","data-testid":"connect-reject-btn",onClick:()=>{e()},fullWidth:!0,size:"large"},l),i.createElement(r.zxk,{"data-testid":"connect-approve-btn",onClick:n,fullWidth:!0,size:"large",color:"secondary"},u("Proceed Anyway")))))}},54725:(e,t,n)=>{n.d(t,{X:()=>i});var a=n(2734),r=n(68483),o=n(67294);function i({title:e,text:t}){const n=(0,a.Z)();return o.createElement(r.bZj,{severity:"warning",icon:o.createElement(r.Qw8,{size:24,color:n.palette.common.black}),sx:{backgroundColor:"warning.light",borderColor:"transparent",px:2,color:"common.black",width:"100%"}},o.createElement(r.BZi,null,o.createElement(r.ZT$,{variant:"caption",sx:{fontWeight:600,display:"block"}},e),o.createElement(r.ZT$,{variant:"caption",sx:{display:"block"}},t)))}},95034:(e,t,n)=>{n.d(t,{W:()=>s});var a=n(67294),r=n(83),o=n(45399),i=n(94975),c=n(73335);function s(e){(0,a.useEffect)((()=>{const t=(0,r.T)((0,o.R)((e=>{window.addEventListener("unload",e)}),(e=>{window.removeEventListener("unload",e)})),(0,o.R)((e=>{window.addEventListener("visibilitychange",e)}),(e=>{window.removeEventListener("visibilitychange",e)})).pipe((0,i.h)((()=>"hidden"===document.visibilityState)))).pipe((0,c.P)()).subscribe((()=>{e()}));return()=>{t.unsubscribe()}}),[e])}}}]);
//# debugId=3c1bc1ca-7c37-57cf-8333-4b7e16357784
