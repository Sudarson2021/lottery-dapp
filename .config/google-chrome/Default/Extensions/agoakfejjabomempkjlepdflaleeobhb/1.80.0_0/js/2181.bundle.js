
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="37ba5042-e079-5827-9e81-a2d922465609")}catch(e){}}();
(self.webpackChunkavalanche_extension=self.webpackChunkavalanche_extension||[]).push([[2181],{50785:(e,t,a)=>{"use strict";a.d(t,{a0:()=>K,Lm:()=>F});var n=a(87462),r=a(43280),i=a(67294),o=a(96505),s=a(82842),l=a(49530),c=a(44905),m=a(26793),u=a(62440),d=a(68483),x=a(90948),p=a(83694),y=a(70739),E=a(1336),g=a(14005),f=a(67294);const h=({message:e})=>f.createElement(d.ZT$,{variant:"caption",sx:{color:"error.light"}},e),b=({value:e})=>f.createElement(d.xuv,{sx:{width:"100%",pt:.5,minHeight:"16px"}},f.createElement(d.ZT$,{variant:"caption",component:"p",sx:{textAlign:"end"}},e)),v=({value:e,fiatValue:t,tokenSymbol:a})=>f.createElement(d.Kqy,{sx:{textAlign:"end",gap:.5}},f.createElement(d.Kqy,{sx:{textAlign:"end"}},f.createElement(d.Kqy,{sx:{flexDirection:"row",gap:.5,justifyContent:"flex-end",alignItems:"center"}},f.createElement(d.ZT$,{variant:"h5",component:"span",color:"text.primary"},e),f.createElement(d.ZT$,{variant:"h6",component:"span",color:"text.secondary"},a)),t&&f.createElement(d.ZT$,{variant:"body2",color:"text.secondary"},t)));function T({feeDisplayDecimals:e,gasLimit:t,isLimitReadonly:a,maxFeePerGas:n,maxPriorityFeePerGas:l,onSave:u,onCancel:x,network:p}){const{t:y}=(0,m.$)(),T=(0,s.l)(p),{currencyFormatter:k}=(0,o.K)(),F=p?.networkToken.decimals??18,[w,S]=(0,i.useState)(t),[C,P]=(0,i.useState)(n),[N,K]=(0,i.useState)(l),[I,G]=(0,i.useState)({}),[Z,q]=(0,i.useState)((0,r.J)({maxFeePerGas:n,tokenPrice:T,tokenDecimals:F,gasLimit:t}));return(0,i.useEffect)((()=>{let e=!1;if(w<=0?(G((e=>({...e,gasLimit:y("Gas Limit too low")}))),e=!0):G((e=>({...e,gasLimit:void 0}))),N>C?(G((e=>({...e,maxPriorityFee:y("Maximum priority fee cannot be greater than maximum fee")}))),e=!0):G((e=>({...e,maxPriorityFee:void 0}))),!e)try{const e=(0,r.J)({maxFeePerGas:C,maxPriorityFeePerGas:N,tokenPrice:T,tokenDecimals:F,gasLimit:w});G({}),q(e)}catch(e){e instanceof Error&&(e.message.includes("overflow")?G((e=>({...e,gasLimit:y("Gas Limit is too much")}))):"Please provide gasPrice or maxFeePerGas parameters"===e.message&&G((e=>({...e,maxFee:y("Provide valid numerical value for maximum fee")}))))}}),[w,C,N,n,y,T,F]),f.createElement(d.Kqy,{sx:{height:"100%"}},f.createElement(E.V,{margin:"16px 0 0",onBackClick:x},y("Edit Network Fee")),f.createElement(d.Kqy,{sx:{padding:2,gap:2.5}},f.createElement(d.Kqy,{sx:{width:"100%",gap:.5}},f.createElement(g.p,{label:y("Max Base Fee"),tooltip:y("The Base Fee is set by the network and changes frequently. Any difference between the set Max Base Fee and the actual Base Fee will be refunded.")}),f.createElement(d.nvn,{fullWidth:!0,type:"number",value:Number(C)/10**e,onChange:t=>{P((0,c.vz)(t.currentTarget.value||"0",e))},error:!!I.maxFee,"data-testid":"max-base-fee"}),I.maxFee?f.createElement(h,{message:I.maxFee}):f.createElement(b,{value:Z.feeUSD?k(Z.feeUSD):""})),f.createElement(d.Kqy,{sx:{width:"100%",gap:.5}},f.createElement(g.p,{label:y("Max Priority Fee"),tooltip:y("The Priority Fee is an incentive paid to network operators to prioritize processing of this transaction.")}),f.createElement(d.nvn,{autoFocus:!0,fullWidth:!0,type:"number",value:Number(N)/10**e,onChange:t=>{K((0,c.vz)(t.currentTarget.value||"0",e))},error:!!I.maxPriorityFee,"data-testid":"max-priority-fee"}),I.maxPriorityFee?f.createElement(h,{message:I.maxPriorityFee}):f.createElement(b,{value:Z.tipUSD?k(Z.tipUSD):""})),f.createElement(d.Kqy,{sx:{width:"100%",gap:.5}},f.createElement(g.p,{label:y("Gas Limit"),tooltip:y(a?"Estimated gas units needed to complete the transaction. Includes a small buffer. Not editable for this transaction.":"Total units of gas needed to complete the transaction. Do not edit unless necessary.")}),f.createElement(d.nvn,{fullWidth:!0,InputProps:{readOnly:a},disabled:a,type:"number",value:w?.toString(),onChange:a?void 0:e=>S(parseInt(e.currentTarget.value)),error:!!I.gasLimit,"data-testid":"gas-limit"}),I.gasLimit&&f.createElement(h,{message:I.gasLimit})),f.createElement(d.izJ,{sx:{mt:2,mb:1}}),f.createElement(d.Kqy,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"start"}},f.createElement(d.Kqy,{sx:{flexDirection:"row",gap:1,alignItems:"center",pt:.75}},f.createElement(d.ZT$,{variant:"caption"},y("Total Network Fee")),f.createElement(d.ua7,{title:f.createElement(f.Fragment,null,f.createElement("div",null,y("Total Network Fee = (Current Base Fee + Max Priority Fee) * Gas Limit.")),f.createElement("br",null),f.createElement("div",null,y("It will never be higher than Max Base Fee * Gas Limit.")))},f.createElement(d.uMt,null))),f.createElement(v,{value:Z.fee,fiatValue:Z.feeUSD?k(Z.feeUSD):null,tokenSymbol:p?.networkToken.symbol}))),f.createElement(d.Kqy,{sx:{flex:1,justifyContent:"flex-end",paddingX:2,paddingBottom:3}},f.createElement(d.zxk,{"data-testid":"save-gas-limit-button",size:"large",variant:"contained",onClick:function(){w&&u({customGasLimit:w,maxFeePerGas:C,maxPriorityFeePerGas:N})},disabled:Object.keys(I).length>0,fullWidth:!0},y("Save"))))}var k=a(67294);let F=function(e){return e.NORMAL="NORMAL",e.FAST="FAST",e.INSTANT="INSTANT",e.CUSTOM="CUSTOM",e}({});const w=({sx:e={},...t})=>k.createElement(d.zxk,(0,n.Z)({sx:{width:"65px",maxHeight:"54px",height:"54px",py:1.5,px:1,display:"inline-flex",flexDirection:"column",gap:.25,justifyContent:"center",borderRadius:1,"&.MuiButton-containedPrimary:hover":{backgroundColor:"primary.main"},...e}},t)),S=({sx:e={},...t})=>k.createElement(d.VqE,(0,n.Z)({fullScreen:!0,PaperProps:{sx:e=>({maxWidth:375,maxHeight:640,backgroundColor:`${e.palette.background.default} !important`})},sx:{"\t.MuiDialog-container":{alignItems:"flex-start"},...e}},t)),C=(0,x.ZP)("input")`
  width: 100%;
  background: transparent;
  font-size: 12px;
  font-weight: 600;
  color: inherit;
  line-height: 1.143;
  text-align: center;
  border: none;
  font-family: ${({theme:e})=>e.typography.caption.fontFamily};
  padding: 0 4px;

  ::-webkit-outer-spin-button,
  ::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
  }
`;function P(e,t){const a=100n*e/10n**BigInt(t);return(0,c.bM)(a,2)}const N=(e,t)=>""===e?e:t?t.high===t.low&&t.high===t?.medium||parseFloat(e)<=1?e:Math.round(parseFloat(e)):void 0;function K({maxFeePerGas:e,limit:t,onChange:a,onModifierChangeCallback:n,gasPriceEditDisabled:x=!1,maxGasPrice:E,selectedGasFeeModifier:g,network:f,networkFee:h,isLimitReadonly:b}){const{t:v}=(0,m.$)(),K=(0,s.l)(f),{currencyFormatter:I}=(0,o.K)(),[G,Z]=(0,i.useState)(),q=G||t,[R,$]=(0,i.useState)(h?.low),[A,D]=(0,i.useState)((0,r.J)({maxFeePerGas:e,tokenPrice:K,tokenDecimals:f?.networkToken.decimals,gasLimit:q})),[M,O]=(0,i.useState)(!1),L=(0,i.useRef)(null),[W,_]=(0,i.useState)(!1),[z,U]=(0,i.useState)(h?.isFixedFee?F.NORMAL:g||F.NORMAL);(0,y.$)(),(0,i.useEffect)((()=>{!R&&h&&$(h?.low)}),[R,h]);const j=(0,i.useCallback)(((e,t)=>{O(!1),t===F.CUSTOM&&$(e);const n=(0,r.J)({maxFeePerGas:e.maxFee,tokenPrice:K,tokenDecimals:f?.networkToken.decimals,gasLimit:q});if(E&&n.bnFee>BigInt(E))return O(!0),void a({customGasLimit:G,maxFeePerGas:e.maxFee,maxPriorityFeePerGas:e.maxTip,feeType:t});D(n),a({customGasLimit:G,maxFeePerGas:e.maxFee,maxPriorityFeePerGas:e.maxTip,feeType:t})}),[K,f?.networkToken.decimals,q,G,E,a]),B=(0,i.useCallback)(((e,t)=>{const a=(0,c.vz)(e,t.displayDecimals),{baseMaxFee:n}=t;return{maxFee:a,maxTip:n&&a>n?a-n:void 0}}),[]),Y=(0,i.useCallback)((e=>{if(e&&h)switch(U(e),e){case F.FAST:j(h.medium,e);break;case F.INSTANT:j(h.high,e);break;case F.CUSTOM:R&&j(R,e);break;default:j(h.low,F.NORMAL)}}),[j,h,R]),H=(0,i.useCallback)((e=>{Y(e),n&&n(e)}),[Y,n]);if((0,i.useEffect)((()=>{"boolean"==typeof h?.isFixedFee&&(h.isFixedFee?Y(F.NORMAL):Y(g))}),[h?.isFixedFee,g,Y]),!h)return null;const V=f?.vmName===l.mK.EVM&&!h.isFixedFee,Q=f?.vmName===l.mK.EVM;return k.createElement(p.p5,null,k.createElement(p._C,{label:v(V?"Maximum Network Fee":"Network Fee"),tooltip:V?v("Core estimates the maximum gas (maxFeePerGas) a transaction could consume based on network conditions. This transaction will likely consume less gas than estimated."):void 0},Q&&k.createElement(d.hU,{size:"small","data-testid":"edit-gas-limit-button",onClick:()=>_(!0)},k.createElement(d.UG6,null))),k.createElement(p.f1,null,k.createElement(d.Kqy,{sx:{flexDirection:"row",justifyContent:"space-between"}},k.createElement(w,{"data-testid":"gas-fee-normal-button",disabled:x,color:z===F.NORMAL?"primary":"secondary",onClick:()=>{H(F.NORMAL)}},k.createElement(d.ZT$,{variant:"body2",sx:{fontWeight:"semibold"}},v("Normal")),k.createElement(d.ZT$,{variant:"caption",sx:{fontWeight:"semibold"}},N(P(h.low.maxFee,h.displayDecimals),h))),!h.isFixedFee&&k.createElement(k.Fragment,null,k.createElement(w,{"data-testid":"gas-fee-fast-button",disabled:x,color:z===F.FAST?"primary":"secondary",onClick:()=>{H(F.FAST)}},k.createElement(d.ZT$,{variant:"body2",sx:{fontWeight:"semibold"}},v("Fast")),k.createElement(d.ZT$,{variant:"caption",sx:{fontWeight:"semibold"}},N(P(h.medium.maxFee,h.displayDecimals),h))),k.createElement(w,{"data-testid":"gas-fee-instant-button",disabled:x,color:z===F.INSTANT?"primary":"secondary",onClick:()=>{H(F.INSTANT)}},k.createElement(d.ZT$,{variant:"body2",sx:{fontWeight:"semibold"}},v("Instant")),k.createElement(d.ZT$,{variant:"caption",sx:{fontWeight:"semibold"}},N(P(h.high.maxFee,h.displayDecimals),h))),k.createElement(w,{"data-testid":"gas-fee-custom-button",disabled:x,color:z===F.CUSTOM?"primary":"secondary",onClick:()=>{H(F.CUSTOM),L?.current?.focus()},disableRipple:!0},k.createElement(d.ZT$,{variant:"body2",sx:{fontWeight:"semibold"}},v("Custom")),k.createElement(C,{ref:L,type:"number",value:N(P(R?.maxFee??0n,h.displayDecimals),h),onChange:e=>{j(B(e.target.value||"0",h),F.CUSTOM)},onBlur:e=>{""===e.target.value&&j(h.low,F.CUSTOM)}})))),k.createElement(d.Kqy,null,k.createElement(d.Kqy,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},k.createElement(d.ZT$,{component:"span",variant:"caption",sx:{color:"text.secondary"}},v("Fee Amount")),k.createElement(d.ZT$,{variant:"body2","data-testid":"network-fee-token-amount",sx:{fontWeight:"fontWeightSemibold"}},A.fee," ",f?.networkToken.symbol)),k.createElement(d.Kqy,{sx:{alignItems:"flex-end"}},k.createElement(d.ZT$,{"data-testid":"network-fee-currency-amount",variant:"caption",sx:{color:"text.secondary"}},isNaN(Number(A.feeUSD))?"":`${I(Number(A.feeUSD))}`)))),M&&k.createElement(d.Kqy,{sx:{py:.5}},k.createElement(d.ZT$,{variant:"caption",sx:{color:"error.main"}},k.createElement(u.c,{i18nKey:"Insufficient balance to cover gas costs. <br />Please add {{tokenSymbol}}.",values:{tokenSymbol:f?.networkToken.symbol}}))),k.createElement(S,{open:Boolean(f?.vmName===l.mK.EVM&&W&&R?.maxFee)},k.createElement(T,{isLimitReadonly:b,feeDisplayDecimals:h.displayDecimals,gasLimit:q,maxFeePerGas:R?.maxFee||0n,maxPriorityFeePerGas:R?.maxTip||0n,onCancel:()=>_(!1),onSave:e=>{Z(e.customGasLimit),$({maxFee:e.maxFeePerGas,maxTip:e.maxPriorityFeePerGas}),U(F.CUSTOM),_(!1),D((0,r.J)({maxFeePerGas:e.maxFeePerGas,tokenPrice:K,tokenDecimals:f?.networkToken.decimals,gasLimit:e.customGasLimit})),a({customGasLimit:e.customGasLimit,maxFeePerGas:e.maxFeePerGas,maxPriorityFeePerGas:e.maxPriorityFeePerGas,feeType:F.CUSTOM})},network:f})))}},14005:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var n=a(68483),r=a(67294);const i=({label:e,tooltip:t})=>r.createElement(n.Kqy,{sx:{flexDirection:"row",alignItems:"center",gap:1}},r.createElement(n.ZT$,{variant:"body2",sx:{fontWeight:"semibold"}},e),t&&r.createElement(n.ua7,{title:t},r.createElement(n.uMt,{size:16})))},32672:(e,t,a)=>{"use strict";a.d(t,{T:()=>u});var n=a(87462),r=a(68483),i=a(57832),o=a(67294),s=a(67294);const l="50%",c="32px",m=e=>{const t=(e||"").split(" "),a=t[0],n=t[t.length-1];return a&&n?a.substring(0,1)+n.substring(0,1):a?a.substring(0,1):""};function u({src:e,children:t,width:a,height:u,name:d,...x}){const[p,y]=(0,o.useState)();if((0,o.useEffect)((()=>{let t=!1;return new Promise(((t,a)=>{if(!e)return void a("no source value");const n=document.createElement("img");n.onerror=e=>{a(e)},n.onload=()=>{t(n)},n.src=(0,i.w)(e)})).then((()=>{!t&&y({success:!0})})).catch((()=>{!t&&y({error:!0})})),()=>{t=!0}}),[d,e]),!p)return s.createElement(r.Kqy,(0,n.Z)({direction:"row",justifyContent:"center",alignItems:"center",sx:{borderRadius:l,backgroundColor:"grey.600",width:a||c,height:u||c,flexShrink:0}},x),s.createElement(r.D8x,{size:5}));if(p.success)return s.createElement(r.Kqy,(0,n.Z)({direction:"row",sx:{borderRadius:l,width:a||c,height:u||c,flexShrink:0}},x,{as:"img",src:(0,i.w)(e)}));if(p.error){const e=m(d);return t??s.createElement(r.Kqy,(0,n.Z)({direction:"row",justifyContent:"center",alignItems:"center",sx:{borderRadius:l,backgroundColor:"grey.600",width:a||c,height:u||c,flexShrink:0}},x),s.createElement(r.ZT$,{variant:"body2",sx:{fontWeight:"fontWeightSemibolds"}},e))}}},83694:(e,t,a)=>{"use strict";a.d(t,{_C:()=>s,f1:()=>l,p5:()=>c});var n=a(87462),r=a(68483),i=a(2734),o=a(67294);const s=({label:e,tooltip:t,tooltipIcon:a=o.createElement(r.uMt,null),children:n})=>o.createElement(r.Kqy,{sx:{width:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},o.createElement(r.Kqy,{sx:{flexDirection:"row",alignItems:"center"}},o.createElement(r.ZT$,{component:"h6"},e),t&&o.createElement(r.ua7,{sx:{cursor:"pointer",ml:1},title:t},a)),o.createElement(r.xuv,null,n)),l=({sx:e={},...t})=>{const a=(0,i.Z)();return o.createElement(r.Kqy,(0,n.Z)({sx:{width:"100%",backgroundColor:"background.paper",borderRadius:1,p:2,gap:1,..."function"==typeof e?e(a):e}},t))},c=({sx:e={},...t})=>{const a=(0,i.Z)();return o.createElement(r.Kqy,(0,n.Z)({sx:{width:"100%",gap:.5,..."function"==typeof e?e(a):e}},t))}},70739:(e,t,a)=>{"use strict";a.d(t,{$:()=>i});var n=a(67294),r=a(99295);const i=()=>{const{registerSubscriber:e,unregisterSubscriber:t}=(0,r.j)();(0,n.useEffect)((()=>(e(),()=>{t()})),[e,t])}},82842:(e,t,a)=>{"use strict";a.d(t,{l:()=>o});var n=a(46935),r=a(69518),i=a(67294);function o(e){const{request:t}=(0,r.K)(),[a,o]=(0,i.useState)(0);return(0,i.useEffect)((()=>{const a=e?.pricingProviders?.coingecko.nativeTokenId;a?t({method:n.a.TOKEN_PRICE_GET,params:[a]}).then((e=>o(e||0))).catch((()=>o(0))):o(0)}),[e,t]),a}},19248:(e,t,a)=>{"use strict";a.d(t,{o:()=>C});var n=a(67294),r=a(26793),i=a(62440),o=a(68483),s=a(49507),l=a(63366),c=a(94277),m=a(1336),u=a(92094),d=a(97778),x=a(87462),p=a(2734),y=a(67294);function E(e){const t=(0,p.Z)();return y.createElement(o.ay,(0,x.Z)({size:38,sx:{outline:`2px solid ${t.palette.error.main}`,outlineOffset:3,backgroundColor:"error.main",m:1,p:2,borderRadius:999,border:1,borderColor:"error.main"}},e))}var g=a(67294);const f=({refreshPermissions:e})=>{const{t}=(0,r.$)();return g.createElement(o.VqE,{open:!0,showCloseIcon:!1,fullWidth:!0,maxWidth:!1,sx:{textAlign:"center"},PaperProps:{sx:{m:2,width:"100%",maxWidth:"none"}}},g.createElement(o.Kqy,{sx:{alignItems:"center",height:"100%",justifyContent:"center",gap:3,py:3,px:2}},g.createElement(o.ZT$,{variant:"h4"},t("Access Blocked")),g.createElement(o.Kqy,{sx:{alignItems:"center",gap:3}},g.createElement(o.ZT$,{variant:"body1"},t("You've blocked access to your camera. Please allow access to continue.")),g.createElement(E,null),g.createElement(o.ZT$,{variant:"body2",color:"text.secondary"},t("If you block access, look in the top right corner of your browser to enable camera access"))),g.createElement(o.Kqy,{sx:{gap:2,width:"100%"}},g.createElement(o.zxk,{color:"primary",size:"medium",fullWidth:!0,onClick:e},t("Done")))))};var h=a(67294);const b=({QRScanner:e})=>{const{t}=(0,r.$)();return h.createElement(o.VqE,{open:!0,showCloseIcon:!1,fullWidth:!0,maxWidth:!1,sx:{textAlign:"center"},PaperProps:{sx:{m:2,width:"100%",maxWidth:"none"}}},h.createElement(o.Kqy,{sx:{alignItems:"center",height:"100%",justifyContent:"center",gap:3,py:3,px:2}},h.createElement(o.ZT$,{variant:"h4"},t("Camera Access")),h.createElement(o.Kqy,{sx:{alignItems:"center",gap:3}},h.createElement(o.ZT$,{variant:"body1"},t("Allow Chrome access to your camera to scan the QR Code")),h.createElement(o.D8x,{size:64,sx:{my:6}}),h.createElement(e,null),h.createElement(o.ZT$,{variant:"body2",color:"text.secondary"},t("If you block access, look in the top right corner of your browser to enable camera access"))),h.createElement(o.Kqy,{sx:{gap:2,width:"100%"}},h.createElement(o.zxk,{fullWidth:!0,size:"medium"},t("Close")),h.createElement(o.zxk,{variant:"text",onClick:()=>{window.open("https://keyst.one","_blank","noreferrer")}},h.createElement(o.h0n,{size:16,sx:{color:"secondary.main",marginRight:1}}),h.createElement(o.ZT$,{variant:"caption",sx:{color:"secondary.main",fontWeight:600}},t("Keystone Support"))))))};var v=a(67294);function T(e){const t=(0,p.Z)();return v.createElement(o.Cge,(0,x.Z)({size:38,sx:{outline:`2px solid ${t.palette.error.main}`,outlineOffset:3,backgroundColor:"error.main",m:1,p:2,borderRadius:999,border:1,borderColor:"error.main"}},e))}var k=a(67294);const F=({onRetry:e})=>{const{t}=(0,r.$)();return k.createElement(o.VqE,{open:!0,showCloseIcon:!1,fullWidth:!0,maxWidth:!1,sx:{textAlign:"center"},PaperProps:{sx:{m:2,width:"100%",maxWidth:"none"}}},k.createElement(o.Kqy,{sx:{alignItems:"center",height:"100%",justifyContent:"center",gap:3,py:3,px:2}},k.createElement(o.ZT$,{variant:"h4"},t("Invalid QR Code")),k.createElement(o.Kqy,{sx:{alignItems:"center",gap:3}},k.createElement(o.ZT$,{variant:"body1"},t("Please ensure you have selected a valid QR code from your Keystone device")),k.createElement(T,null)),k.createElement(o.Kqy,{sx:{gap:2,width:"100%"}},k.createElement(o.zxk,{color:"primary",size:"medium",fullWidth:!0,onClick:e},t("Retry")))))};var w=a(67294),S=function(e){return e[e.SCAN_WITH_KEYSTONE=0]="SCAN_WITH_KEYSTONE",e[e.SCAN_FROM_KEYSTONE=-1]="SCAN_FROM_KEYSTONE",e}(S||{});function C({onReject:e}){const{t}=(0,r.$)(),a=(0,u.Z)(),[x,p]=(0,n.useState)(S.SCAN_WITH_KEYSTONE),[y,E]=(0,n.useState)(!1),[g,h]=(0,n.useState)(!1),{txRequest:v,submitSignature:T}=(0,d.t)(),[k,C]=(0,n.useState)(!1),[P,N]=(0,n.useState)(!1),[K,I]=(0,n.useState)(!1);(0,n.useEffect)((()=>{v&&(p(S.SCAN_WITH_KEYSTONE),E(!1))}),[v]),(0,n.useEffect)((()=>{!y&&g&&I(!0)}),[g,y]);const G=(0,n.useCallback)((()=>{x===S.SCAN_WITH_KEYSTONE?e?.():p(S.SCAN_WITH_KEYSTONE)}),[x,e]),Z=(0,n.useCallback)((async(e,t)=>{v&&await T({requestId:v.requestId,cbor:e,type:t})}),[T,v]),q=(0,n.useCallback)((async({cbor:e,type:t})=>{if(x===S.SCAN_FROM_KEYSTONE&&!y){E(!0),h(!0);try{await Z(e,t)}catch(e){C(!0),E(!1)}}}),[Z,y,x]),R=(0,n.useCallback)((e=>{e&&!e.includes("Dimensions")&&C(!0)}),[]),{permissions:$,refreshPermissions:A}=function(){const[e,t]=(0,n.useState)(),[a,r]=(0,n.useState)(),i=(0,n.useCallback)((async()=>{const e=await navigator.permissions.query({name:"camera"});e.onchange=()=>r(e.state),r(e.state),t(e)}),[]);return(0,n.useEffect)((()=>{i()}),[i]),(0,n.useEffect)((()=>{const t=e;return()=>{t&&(t.onchange=null)}}),[e]),{permissions:a,refreshPermissions:i}}(),D=(0,n.useMemo)((()=>({urTypes:[s.URType.EVM_SIGNATURE,s.URType.ETH_SIGNATURE,l.RegistryTypes.CRYPTO_PSBT.getType()],handleError:R,handleScan:q,options:{width:y||"granted"!==$?1:220,height:y||"granted"!==$?1:220}})),[R,q,y,$]),M=(0,n.useMemo)((()=>()=>w.createElement(s.AnimatedQRScanner,D)),[D]);return(0,n.useEffect)((()=>{N("denied"===$)}),[$]),a&&v?w.createElement(c.a,{isBackgroundFilled:!0},w.createElement(o.Kqy,{sx:{width:"100%",height:"100%",pt:2,pb:3,gap:K?1.5:2}},K&&w.createElement(o.bZj,{severity:"info",onClose:()=>I(!1),sx:{mx:2}},w.createElement(o.CdC,null,t("This is a new approval")),t("This transaction requires multiple approvals.")),w.createElement(m.V,{onBackClick:G,margin:"0"},t("Scan QR Code")),w.createElement(o.xuv,{sx:{width:"100%",overflowX:"hidden",overflowY:"hidden"}},w.createElement(o.Kqy,{sx:{width:"200%",flexDirection:"row",transition:"transform 0.1s ease-in-out",transform:`translateX(calc(50% * ${x}))`}},w.createElement(o.Kqy,{sx:{gap:K?2.5:5,alignItems:"center",flex:1,px:2}},w.createElement(o.ZT$,{variant:"body1"},w.createElement(i.c,{i18nKey:"Scan the QR code with your <deviceName>Keystone device</deviceName>",components:{deviceName:w.createElement(o.ZT$,{variant:"h6",component:"span"})}})),v?w.createElement(s.AnimatedQRCode,{cbor:v.cbor,type:v.type,options:{size:220}}):w.createElement(o.D8x,{size:100}),w.createElement(o.ZT$,{variant:"body2",color:"text.secondary",textAlign:"center"},t("Click on the 'Get Signature' button after signing the transaction with your Keystone device."))),w.createElement(o.Kqy,{sx:{gap:5,alignItems:"center",flex:1,px:K?1.5:2}},w.createElement(o.ZT$,{variant:"body1"},w.createElement(i.c,{i18nKey:"Scan the QR code displayed on your <deviceName>Keystone device</deviceName>",components:{deviceName:w.createElement(o.ZT$,{variant:"h6",component:"span"})}})),w.createElement(o.Kqy,{sx:{minHeight:220,justifyContent:"center"}},y&&w.createElement(o.D8x,{size:100}),w.createElement(M,null)),w.createElement(o.ZT$,{variant:"body2",color:"text.secondary"},t("Position the QR code in front of your camera."))),x===S.SCAN_FROM_KEYSTONE&&w.createElement(w.Fragment,null,k&&w.createElement(F,{onRetry:()=>{C(!1),E(!1)}}),P&&w.createElement(f,{refreshPermissions:A}),!$||"prompt"===$&&w.createElement(b,{QRScanner:M})))),w.createElement(o.Kqy,{sx:{flexDirection:"row",alignItems:"flex-end",width:"100%",flexGrow:1,justifyContent:"space-between",px:2,gap:1}},w.createElement(o.zxk,{color:"secondary","data-testid":"transaction-keystone-reject-btn",size:"large",onClick:e,fullWidth:!0,disabled:y},t("Reject")),x===S.SCAN_WITH_KEYSTONE&&w.createElement(o.zxk,{"data-testid":"transaction-keystone-approve-btn",size:"large",onClick:()=>p(S.SCAN_FROM_KEYSTONE),fullWidth:!0},t("Get Signature"))))):null}},84012:(e,t,a)=>{"use strict";a.d(t,{j:()=>i});var n=a(739),r=a(13550);function i(e,t){return(0,n.N)(new r.BN(e.toString()),t)}},43280:(e,t,a)=>{"use strict";a.d(t,{J:()=>i});var n=a(27822),r=a(84012);function i({gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:a,tokenPrice:i,tokenDecimals:o=18,gasLimit:s}){const l=t??e;if(null==l)throw new Error("Please provide gasPrice or maxFeePerGas parameters");const c=s?l*BigInt(s):l,m=s&&a?a*BigInt(s):a,u=(0,n.v)((0,r.j)(c,o),8),d=m?(0,n.v)((0,r.j)(m,o),8):null;return{maxFeePerGas:t,gasLimit:s||0,fee:u,bnFee:c,feeUSD:i?parseFloat((parseFloat(u)*i).toFixed(4)):null,tipUSD:i&&d?parseFloat((parseFloat(d)*i).toFixed(4)):null}}},69159:()=>{}}]);
//# debugId=37ba5042-e079-5827-9e81-a2d922465609
